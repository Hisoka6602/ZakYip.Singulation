# 贡献指南

感谢您对 ZakYip.Singulation 项目的关注！本文档提供了参与项目开发的详细指南。

## 目录

1. [基本原则](#基本原则)
2. [文档规范](#文档规范)
3. [代码规范](#代码规范)
4. [提交流程](#提交流程)
5. [Pull Request 指南](#pull-request-指南)

## 基本原则

- 保持代码简洁、可读、易维护
- 遵循现有的项目架构和设计模式
- 编写必要的单元测试
- 保持代码风格一致
- **文档与代码同步更新**

## 文档规范

### 语言要求

**所有 Markdown 文档必须使用中文编写。**

这包括但不限于：
- `README.md` - 项目主文档
- `docs/` 目录下的所有文档
- `ops/` 目录下的运维文档
- 各模块内的技术文档
- 代码中的 XML 注释和重要说明

### 文档更新要求

**每次代码变更都必须同步更新相关文档。**

#### 必须更新文档的情况

1. **添加新功能**
   - 在 `README.md` 的"本次更新"部分记录新功能
   - 如果涉及 API 变更，更新 `docs/API.md`
   - 如果涉及 MAUI 应用，更新 `docs/MAUIAPP.md`
   - 在相关模块文档中添加详细说明

2. **修改现有功能**
   - 更新相关功能的文档说明
   - 修改示例代码和使用说明
   - 更新配置说明和参数文档

3. **修复 Bug**
   - 在 `README.md` 中记录重要的 Bug 修复
   - 更新相关的故障排查文档

4. **架构变更**
   - 更新架构说明和组件关系图
   - 修改部署和运维文档
   - 更新依赖项和版本信息

5. **API 变更**
   - 更新 `docs/API.md` 中的接口定义
   - 修改请求/响应示例
   - 更新 Swagger 注释

#### 文档更新检查清单

在提交 Pull Request 之前，请确认：

- [ ] 所有新增或修改的文档使用中文
- [ ] `README.md` 的"本次更新"部分已更新
- [ ] 相关模块的文档已同步更新
- [ ] 示例代码和配置说明与实际代码一致
- [ ] API 文档反映了最新的接口定义
- [ ] 部署和构建文档准确无误

### 文档结构规范

#### 标题层级
- 使用 `#` 表示一级标题（仅用于文档标题）
- 使用 `##` 表示二级标题（章节）
- 使用 `###` 表示三级标题（子章节）
- 避免使用超过四级的标题

#### 代码块
- 使用三个反引号包裹代码块
- 指定代码语言，如 \`\`\`bash, \`\`\`csharp, \`\`\`json
- 添加必要的注释说明

#### 列表
- 使用 `-` 表示无序列表
- 使用 `1.`, `2.` 表示有序列表
- 保持列表层级清晰

## 代码规范

### 命名规范

- **类名**：使用 PascalCase，如 `AxisController`
- **接口名**：使用 PascalCase，以 `I` 开头，如 `IAxisDriver`
- **方法名**：使用 PascalCase，如 `GetControllerStatus`
- **私有字段**：使用 camelCase，以 `_` 开头，如 `_logger`
- **属性**：使用 PascalCase，如 `AxisCount`
- **常量**：使用 PascalCase，如 `MaxAxisCount`

### 注释规范

- 公共 API 必须添加 XML 文档注释
- 复杂逻辑必须添加说明注释
- 重要的配置和参数必须注释说明用途

示例：
```csharp
/// <summary>
/// 获取控制器状态
/// </summary>
/// <param name="cancellationToken">取消令牌</param>
/// <returns>控制器状态信息</returns>
public async Task<ControllerStatus> GetStatusAsync(CancellationToken cancellationToken = default)
{
    // 实现代码
}
```

### 代码风格

- 使用 4 个空格缩进（不使用 Tab）
- 左花括号 `{` 独占一行
- 每行代码长度不超过 120 字符
- 使用空行分隔逻辑块

## 提交流程

### 1. Fork 项目

从 GitHub 上 Fork 本项目到您的账户。

### 2. 克隆仓库

```bash
git clone https://github.com/YOUR_USERNAME/ZakYip.Singulation.git
cd ZakYip.Singulation
```

### 3. 创建分支

```bash
git checkout -b feature/your-feature-name
```

分支命名规范：
- 新功能：`feature/功能名称`
- Bug 修复：`fix/问题描述`
- 文档更新：`docs/文档名称`
- 性能优化：`perf/优化内容`

### 4. 进行开发

- 编写代码
- **同步更新文档**
- 运行测试确保通过

```bash
# 构建项目
dotnet build

# 运行测试
dotnet test
```

### 5. 提交变更

```bash
# 添加变更文件
git add .

# 提交变更（使用中文提交信息）
git commit -m "添加：新增轴速度控制功能及文档"

# 推送到远程分支
git push origin feature/your-feature-name
```

提交信息规范：
- 使用中文描述变更内容
- 简洁明了，一句话概括主要变更
- 可以包含多个文件，但主题要明确

示例：
- ✅ "添加：新增轴速度控制功能及 API 文档"
- ✅ "修复：解决 SignalR 连接断开问题并更新故障排查文档"
- ✅ "更新：将 MIGRATION_SUMMARY.md 翻译为中文"
- ❌ "update code"（不使用英文，不够具体）
- ❌ "修改了一些文件"（不够明确）

### 6. 创建 Pull Request

在 GitHub 上创建 Pull Request，填写以下信息：

- **标题**：简要说明变更内容
- **描述**：详细说明
  - 变更的目的和原因
  - 主要改动内容
  - 文档更新情况
  - 测试验证情况
- **关联 Issue**：如果相关，引用对应的 Issue

## Pull Request 指南

### PR 检查清单

在提交 PR 之前，请确认：

- [ ] 代码编译通过
- [ ] 所有测试通过
- [ ] 新功能有对应的测试
- [ ] 代码符合项目规范
- [ ] **所有相关文档已更新为中文**
- [ ] XML 注释完整准确
- [ ] 提交信息清晰明确

### PR 模板示例

```markdown
## 变更说明
简要描述本次变更的目的和内容。

## 主要改动
- 新增 XXX 功能
- 修复 XXX 问题
- 优化 XXX 性能

## 文档更新
- [x] 更新 README.md，在"本次更新"中记录变更
- [x] 更新 docs/API.md，添加新接口文档
- [x] 所有文档使用中文

## 测试情况
- [x] 单元测试通过
- [x] 手动测试通过
- [x] 构建成功

## 相关 Issue
关闭 #123
```

### Code Review

维护者会审查您的 Pull Request，可能会：
- 提出修改建议
- 要求补充测试
- 要求更新文档
- 要求调整代码风格

请及时响应反馈，并进行相应的修改。

## 问题报告

### 报告 Bug

使用 GitHub Issues 报告 Bug，请包含：
- 问题描述
- 复现步骤
- 预期行为
- 实际行为
- 环境信息（操作系统、.NET 版本等）
- 相关日志和错误信息

### 功能建议

欢迎提出功能建议，请说明：
- 功能描述
- 使用场景
- 预期收益
- 实现思路（可选）

## 行为准则

- 尊重所有贡献者
- 友好、专业地交流
- 接受建设性批评
- 关注项目的最佳利益

## 获取帮助

如有疑问，可以：
- 在 GitHub Issues 中提问
- 查看现有文档
- 参考项目示例代码

---

再次感谢您的贡献！让我们一起让 ZakYip.Singulation 变得更好！

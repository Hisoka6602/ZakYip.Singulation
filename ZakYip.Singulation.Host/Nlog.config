<?xml version="1.0" encoding="utf-8" ?>
<Nlog xmlns="http://www.nlog-project.org/schemas/NLog.xsd"
      xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
	<targets>
		<!-- 控制台（开发期可留） -->
		<target xsi:type="Console" name="console"
				layout="${longdate}|${level}|${logger}|${message} ${exception:format=tostring}" />

		<!-- 应用级 -->
		<target xsi:type="File" name="appFile"
				fileName="${basedir}/logs/app/${shortdate}.log"
				archiveNumbering="Rolling" archiveEvery="Day" maxArchiveFiles="14"
				layout="${longdate}|${level}|${logger}|${message} ${exception:format=tostring}" />

		<!-- 传输：TransportEventPump / *transport* -->
		<target xsi:type="File" name="transportFile"
				fileName="${basedir}/logs/transport/${shortdate}.log"
				archiveNumbering="Rolling" archiveEvery="Day" maxArchiveFiles="14"
				layout="${longdate}|${level}|${logger}|${message} ${exception:format=tostring}" />

		<!-- 上游：UpstreamFrameHub / *upstream* -->
		<target xsi:type="File" name="upstreamFile"
				fileName="${basedir}/logs/upstream/${shortdate}.log"
				archiveNumbering="Rolling" archiveEvery="Day" maxArchiveFiles="14"
				layout="${longdate}|${level}|${logger}|${message} ${exception:format=tostring}" />

		<!-- 轴侧：Axis* / *axis* -->
		<target xsi:type="File" name="axisFile"
				fileName="${basedir}/logs/axis/${shortdate}.log"
				archiveNumbering="Rolling" archiveEvery="Day" maxArchiveFiles="14"
				layout="${longdate}|${level}|${logger}|${message} ${exception:format=tostring}" />
	</targets>

	<rules>
		<!-- 指向具体命名空间的优先路由 -->
		<logger name="ZakYip.Singulation.Host.Workers.TransportEventPump*" minlevel="Debug" writeTo="transportFile" />
		<logger name="ZakYip.Singulation.Host.Runtime.UpstreamFrameHub*" minlevel="Info" writeTo="upstreamFile" />
		<logger name="ZakYip.Singulation.Drivers.*" minlevel="Info" writeTo="axisFile" />

		<!-- 兜底的关键词路由（命名空间外的类也能被收敛） -->
		<logger name="*transport*" minlevel="Info" writeTo="transportFile" />
		<logger name="*upstream*"  minlevel="Info" writeTo="upstreamFile" />
		<logger name="*axis*"      minlevel="Info" writeTo="axisFile" />

		<!-- 其余都进 app（同时输出到控制台便于开发观察） -->
		<logger name="*" minlevel="Info" writeTo="appFile,console" />
	</rules>
</Nlog>
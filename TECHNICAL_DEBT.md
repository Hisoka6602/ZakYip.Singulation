# æŠ€æœ¯å€ºåŠ¡è¿½è¸ª (Technical Debt Tracking)

**æœ€åæ›´æ–°**: 2025-12-14  
**ç»´æŠ¤è€…**: ZakYip.Singulation å›¢é˜Ÿ

---

## ğŸ“‹ ä½¿ç”¨è¯´æ˜

### ç›®çš„
æœ¬æ–‡æ¡£è¿½è¸ªé¡¹ç›®ä¸­æ‰€æœ‰å·²è¯†åˆ«çš„æŠ€æœ¯å€ºåŠ¡ï¼Œç¡®ä¿å›¢é˜Ÿæœ‰è®¡åˆ’åœ°è§£å†³è¿™äº›é—®é¢˜ï¼Œé˜²æ­¢æŠ€æœ¯å€ºåŠ¡ç´¯ç§¯ã€‚

### è§„åˆ™
1. **æ¯æ¬¡æäº¤PRå‰**ï¼šå¿…é¡»å…ˆæŸ¥çœ‹æœ¬æ–‡æ¡£ï¼Œä¼˜å…ˆå¤„ç†æœªå®Œæˆçš„é«˜ä¼˜å…ˆçº§æŠ€æœ¯å€ºåŠ¡
2. **æ¯æ¬¡PRæäº¤æ—¶**ï¼šæ›´æ–°æœ¬æ–‡æ¡£ï¼Œæ ‡è®°å·²å®Œæˆçš„é¡¹ç›®ï¼Œæ·»åŠ æ–°å‘ç°çš„æŠ€æœ¯å€ºåŠ¡
3. **ç¦æ­¢åˆå¹¶**ï¼šå¦‚æœæœ‰æœªå¤„ç†çš„å…³é”®ï¼ˆP0ï¼‰æŠ€æœ¯å€ºåŠ¡ï¼ŒPRä¸åº”è¢«åˆå¹¶
4. **å®šæœŸå®¡æŸ¥**ï¼šæ¯æœˆå®¡æŸ¥ä¸€æ¬¡ï¼Œé‡æ–°è¯„ä¼°ä¼˜å…ˆçº§

### ä¼˜å…ˆçº§å®šä¹‰
- **P0 (å…³é”®)**: é˜»å¡æ€§é—®é¢˜ï¼Œå¿…é¡»ç«‹å³ä¿®å¤
- **P1 (é«˜)**: ä¸¥é‡å½±å“ä»£ç è´¨é‡ï¼Œåº”åœ¨1-2å‘¨å†…ä¿®å¤
- **P2 (ä¸­)**: ä¸­ç­‰å½±å“ï¼Œåº”åœ¨1ä¸ªæœˆå†…ä¿®å¤
- **P3 (ä½)**: è½»å¾®å½±å“ï¼Œå¯åœ¨æœ‰ç©ºé—²æ—¶é—´æ—¶ä¿®å¤

### çŠ¶æ€å®šä¹‰
- â³ **å¾…å¤„ç† (Pending)**: å°šæœªå¼€å§‹
- ğŸ”„ **è¿›è¡Œä¸­ (In Progress)**: æ­£åœ¨å¤„ç†
- âœ… **å·²å®Œæˆ (Done)**: å·²ä¿®å¤å¹¶éªŒè¯
- ğŸš« **å·²å–æ¶ˆ (Cancelled)**: å†³å®šä¸ä¿®å¤
- ğŸ” **å·²æ¨è¿Ÿ (Deferred)**: æ¨è¿Ÿåˆ°æœªæ¥å¤„ç†

---

## ğŸ”´ P0 - å…³é”®æŠ€æœ¯å€ºåŠ¡ (Critical)

> è¿™äº›é—®é¢˜å¿…é¡»åœ¨ä¸‹ä¸€ä¸ªPRä¸­è§£å†³

### æ— å…³é”®æŠ€æœ¯å€ºåŠ¡ âœ…

å½“å‰æ²¡æœ‰é˜»å¡æ€§çš„å…³é”®æŠ€æœ¯å€ºåŠ¡ã€‚

---

## ğŸŸ  P1 - é«˜ä¼˜å…ˆçº§æŠ€æœ¯å€ºåŠ¡ (High Priority)

### TD-NEW-001: å¤šä¸ªæŠ€æœ¯å€ºåŠ¡æ–‡ä»¶è¿åç»Ÿä¸€ç®¡ç†è§„èŒƒ
**çŠ¶æ€**: âœ… å·²å®Œæˆ  
**å®Œæˆæ—¥æœŸ**: 2025-12-14  
**å‘ç°æ—¥æœŸ**: 2025-12-14  
**ä¼˜å…ˆçº§**: P1  
**å½±å“èŒƒå›´**: æ–‡æ¡£ç®¡ç†  
**å·¥ä½œé‡**: 1å°æ—¶

**é—®é¢˜æè¿°**:
é¡¹ç›®æ ¹ç›®å½•å­˜åœ¨2ä¸ªæŠ€æœ¯å€ºåŠ¡æ–‡ä»¶ï¼š
1. `TECHNICAL_DEBT.md` - ä¸»è¦æŠ€æœ¯å€ºåŠ¡è¿½è¸ªæ–‡æ¡£
2. `DEBT_CLEANUP_REPORT.md` - å€ºåŠ¡æ¸…ç†å†å²æŠ¥å‘Š

è¿™è¿åäº† copilot-instructions.md ç¬¬ 15.3 èŠ‚çš„è§„èŒƒï¼š**ä»…å…è®¸ä¸€ä¸ªæŠ€æœ¯å€ºåŠ¡æ–‡ä»¶ (TECHNICAL_DEBT.md)**

**å½±å“**:
- ä¿¡æ¯åˆ†æ•£ï¼Œéš¾ä»¥ç»Ÿä¸€ç®¡ç†
- åç»­ PR ä¸çŸ¥é“åº”è¯¥è¯»å–å“ªä¸ªæ–‡ä»¶
- è¿åç¼–ç æ ‡å‡†

**ä¿®å¤æ–¹æ¡ˆ**:
1. âœ… å°† DEBT_CLEANUP_REPORT.md ä¸­çš„å·²å®Œæˆå·¥ä½œåˆå¹¶åˆ° TECHNICAL_DEBT.md
2. âœ… åˆ é™¤ DEBT_CLEANUP_REPORT.md
3. âœ… æ›´æ–°æ–‡æ¡£å¼•ç”¨

**æ‰§è¡Œç»“æœ**:
- âœ… DEBT_CLEANUP_REPORT.md å†…å®¹å·²åˆå¹¶åˆ°"å·²å®Œæˆçš„æŠ€æœ¯å€ºåŠ¡"ç« èŠ‚
- âœ… DEBT_CLEANUP_REPORT.md å·²åˆ é™¤
- âœ… ä»…ä¿ç•™ TECHNICAL_DEBT.md ä¸€ä¸ªæ–‡ä»¶

**è´£ä»»äºº**: GitHub Copilot  
**å®Œæˆæ—¥æœŸ**: 2025-12-14

---

### TD-NEW-002: DateTime.Now/UtcNow ç›´æ¥ä½¿ç”¨æœªé€šè¿‡æŠ½è±¡
**çŠ¶æ€**: ğŸ”„ è¿›è¡Œä¸­ (53% å®Œæˆ)
**å‘ç°æ—¥æœŸ**: 2025-12-14  
**å¼€å§‹æ—¥æœŸ**: 2025-12-14  
**ä¼˜å…ˆçº§**: P1  
**å½±å“èŒƒå›´**: å¤šä¸ªå±‚  
**é¢„è®¡å‰©ä½™å·¥ä½œé‡**: 12-16å°æ—¶

**é—®é¢˜æè¿°**:
é¡¹ç›®ä¸­æœ‰99å¤„ç›´æ¥ä½¿ç”¨ `DateTime.Now` æˆ– `DateTime.UtcNow`ï¼Œè¿åäº†ç¼–ç æ ‡å‡†ä¸­çš„æ—¶é—´å¤„ç†è§„èŒƒï¼ˆç¬¬17èŠ‚æ£€æŸ¥æ¸…å•ï¼‰ã€‚æ ‡å‡†è¦æ±‚æ‰€æœ‰æ—¶é—´è·å–åº”é€šè¿‡æŠ½è±¡æ¥å£ï¼ˆå¦‚ `ISystemClock`ï¼‰ã€‚

**å½“å‰è¿›åº¦**: 26/49 æ–‡ä»¶å®Œæˆ (çº¦53%)
- âœ… å·²å®Œæˆ: 26 æ–‡ä»¶ï¼Œçº¦40å¤„ DateTime æ›¿æ¢
- ğŸ”„ è¿›è¡Œä¸­: 23 æ–‡ä»¶ï¼Œçº¦35å¤„ DateTime å¾…æ›¿æ¢

**å·²å®Œæˆçš„æ–‡ä»¶** (commit aa692b2):
1. âœ… `Infrastructure/Logging/LogSampler.cs` - 3å¤„æ›¿æ¢
2. âœ… `Infrastructure/Cabinet/FrameGuard.cs` - 3å¤„æ›¿æ¢
3. âœ… `Infrastructure/Runtime/RuntimeStatusProvider.cs` - 3å¤„æ›¿æ¢
4. âœ… `Infrastructure/Services/ExceptionAggregationService.cs` - 4å¤„æ›¿æ¢
5. âœ… `Infrastructure/Services/OperationStateTracker.cs` - 2å¤„æ›¿æ¢ (å«å…¼å®¹æ–¹æ³•)
6. âœ… `Infrastructure/Services/FaultDiagnosisService.cs` - 6å¤„æ›¿æ¢
7. âœ… `Infrastructure/Services/SpeedLinkageService.cs` - 2å¤„æ›¿æ¢
8. âœ… `Infrastructure/Services/ConfigurationImportExportService.cs` - 2å¤„æ›¿æ¢
9. âœ… `Host/Program.cs` - æ³¨å†Œ ISystemClock åˆ° DI å®¹å™¨
10. âœ… `Core/Abstractions/ISystemClock.cs` - æ–°å»ºæ¥å£
11. âœ… `Infrastructure/Runtime/SystemClock.cs` - æ–°å»ºå®ç°

**æ–°å¢å®Œæˆçš„æ–‡ä»¶** (commit d87953b):
12. âœ… `Infrastructure/Workers/LogsCleanupService.cs` - 2å¤„æ›¿æ¢ï¼ˆç±»ï¼šLogsCleanupServiceï¼Œä½¿ç”¨ ISystemClockï¼‰

**æ–°å¢å®Œæˆçš„æ–‡ä»¶** (commit b16a7c1):
13. âœ… `Infrastructure/Services/ConnectionHealthCheckService.cs` - CheckedAt å­—æ®µæ”¹ç”¨ ISystemClockï¼ˆç±»ï¼šConnectionHealthCheckServiceï¼‰
14. âœ… `Infrastructure/Services/RealtimeAxisDataService.cs` - æ—¶é—´æˆ³æ”¹ç”¨ ISystemClockï¼ˆç±»ï¼šRealtimeAxisDataServiceï¼‰
15. âœ… `Infrastructure/Services/SystemHealthMonitorService.cs` - å¥åº·å¿«ç…§æ—¶é—´æ”¹ç”¨ ISystemClockï¼ˆç±»ï¼šSystemHealthMonitorServiceï¼‰
16. âœ… `Infrastructure/Workers/SpeedFrameWorker.cs` - RTT è®¡ç®—æ”¹ç”¨ ISystemClockï¼ˆç±»ï¼šSpeedFrameWorkerï¼‰
17. âœ… `Transport/Tcp/TcpClientByteTransport/TouchClientByteTransport.cs` - äº‹ä»¶æ—¶é—´æˆ³æ”¹ç”¨ ISystemClockï¼ˆç±»ï¼šTouchClientByteTransportï¼‰
18. âœ… `Transport/Tcp/TcpServerByteTransport/TouchServerByteTransport.cs` - äº‹ä»¶æ—¶é—´æˆ³æ”¹ç”¨ ISystemClockï¼ˆç±»ï¼šTouchServerByteTransportï¼‰
19. âœ… `Core/Contracts/Events/BytesReceivedEventArgs.cs` - ç§»é™¤é»˜è®¤æ—¶é—´ï¼Œè°ƒç”¨æ–¹æä¾›ï¼ˆç±»å‹ï¼šBytesReceivedEventArgsï¼‰
20. âœ… `Core/Contracts/Events/Cabinet/CabinetStateChangedEventArgs.cs` - ç§»é™¤é»˜è®¤æ—¶é—´ï¼Œè°ƒç”¨æ–¹æä¾›ï¼ˆç±»å‹ï¼šCabinetStateChangedEventArgsï¼‰
21. âœ… `Core/Contracts/Events/Cabinet/CabinetTriggerEventArgs.cs` - ç§»é™¤é»˜è®¤æ—¶é—´ï¼Œè°ƒç”¨æ–¹æä¾›ï¼ˆç±»å‹ï¼šCabinetTriggerEventArgsï¼‰
22. âœ… `Core/Contracts/Events/Cabinet/RemoteLocalModeChangedEventArgs.cs` - ç§»é™¤é»˜è®¤æ—¶é—´ï¼Œè°ƒç”¨æ–¹æä¾›ï¼ˆç±»å‹ï¼šRemoteLocalModeChangedEventArgsï¼‰
23. âœ… `Core/Contracts/Events/LogEvent.cs` - ç§»é™¤é»˜è®¤æ—¶é—´ï¼Œè°ƒç”¨æ–¹æä¾›ï¼ˆç±»å‹ï¼šLogEventï¼‰
24. âœ… `Core/Contracts/Events/TransportErrorEventArgs.cs` - ç§»é™¤é»˜è®¤æ—¶é—´ï¼Œè°ƒç”¨æ–¹æä¾›ï¼ˆç±»å‹ï¼šTransportErrorEventArgsï¼‰
25. âœ… `Core/Contracts/Dto/SystemRuntimeStatus.cs` - å¯åŠ¨æ—¶é—´ç”±è°ƒç”¨æ–¹è®¾ç½®ï¼ˆç±»å‹ï¼šSystemRuntimeStatusï¼‰
26. âœ… `Core/Configs/FaultDiagnosisEntities.cs` - è¯Šæ–­/çŸ¥è¯†åº“æ—¶é—´ç”±è°ƒç”¨æ–¹æˆ–æœåŠ¡è®¾ç½®ï¼ˆç±»å‹ï¼šFaultDiagnosisEntry/FaultKnowledgeEntryï¼‰

**æ–°å¢å®Œæˆçš„æ–‡ä»¶** (commit ee24c42):
27. âœ… `Host/SignalR/RealtimeDispatchService.cs` - ä¿¡å°æ—¶é—´æˆ³ä¸æ–­è·¯å™¨çŠ¶æ€ç»Ÿä¸€ä½¿ç”¨ ISystemClockï¼ˆç±»ï¼šRealtimeDispatchServiceï¼‰
28. âœ… `Host/SignalR/SpeedLinkageHealthCheck.cs` - å¥åº·æ£€æŸ¥æ—¶é—´çª—è®¡ç®—æ”¹ç”¨ ISystemClockï¼ˆç±»ï¼šSpeedLinkageHealthCheckï¼‰
29. âœ… `Tests/AxisControllerTests.cs` - ä½¿ç”¨å›ºå®šæ—¶é—´å€¼æ›¿ä»£ DateTime.UtcNowï¼Œä¿æŒæµ‹è¯•ç¨³å®š
30. âœ… `Tests/SignalRTests.cs` - æ³¨å…¥ ISystemClock ä»¥åŒ¹é… RealtimeDispatchService æ„é€ ç­¾å
31. âœ… `Tests/SpeedLinkageHealthCheckTests.cs` - æ³¨å…¥ ISystemClock å¹¶ä½¿ç”¨å›ºå®šæ—¶é—´å€¼è¦†ç›–æ—¶é—´çª—å£åˆ¤æ–­

**å‰©ä½™æ–‡ä»¶æ¸…å•** (23 æ–‡ä»¶ï¼ŒæŒ‰ä¼˜å…ˆçº§æ’åº):

**ã€ä¸­ä¼˜å…ˆçº§ - Drivers å±‚ã€‘** (4 æ–‡ä»¶)
1. `Drivers/Leadshine/EmcResetCoordinator.cs` - 1å¤„
2. `Drivers/Leadshine/EmcResetNotification.cs` - 1å¤„
3. `Drivers/Leadshine/LeadshineLtdmcAxisDrive.cs` - 1å¤„
4. `Drivers/Leadshine/LeadshineLtdmcBusAdapter.cs` - 2å¤„

**ã€ä¸­ä¼˜å…ˆçº§ - Protocol å±‚ã€‘** (2 æ–‡ä»¶)
5. `Protocol/Vendors/Guiwei/GuiweiCodec.cs` - 1å¤„
6. `Protocol/Vendors/Huarary/HuararyCodec.cs` - 1å¤„

**ã€ä¸­ä¼˜å…ˆçº§ - Host å±‚ã€‘** (4 æ–‡ä»¶)
7. `Host/Controllers/ConfigurationController.cs` - 1å¤„
8. `Host/Controllers/MonitoringController.cs` - 1å¤„
9. `Host/Dto/ConnectionHealthDto.cs` - 1å¤„ (é»˜è®¤å€¼)
10. `Host/SignalR/RealtimeDispatchService.cs` - 4å¤„
11. `Host/SignalR/SpeedLinkageHealthCheck.cs` - 4å¤„

**ã€ä½ä¼˜å…ˆçº§ - Tests å±‚ã€‘** (2 æ–‡ä»¶)
12. `Tests/AxisControllerTests.cs` - 7å¤„
13. `Tests/SpeedLinkageHealthCheckTests.cs` - 7å¤„

**ã€ä½ä¼˜å…ˆçº§ - Othersã€‘** (9 æ–‡ä»¶) - Benchmarks, Demo, MauiApp
14. `Benchmarks/LongRunningStabilityTest.cs` - 5å¤„
15. `ConsoleDemo/Regression/RegressionRunner.cs` - 1å¤„
16. `MauiApp/Helpers/ModuleCacheManager.cs` - 2å¤„
17. `MauiApp/Helpers/SafeExecutor.cs` - 2å¤„
18. `MauiApp/Helpers/ServiceCacheHelper.cs` - 2å¤„
19. `MauiApp/Services/NotificationService.cs` - 1å¤„
20. `MauiApp/Services/SignalRClientFactory.cs` - 5å¤„
21. `MauiApp/Services/UdpDiscoveryClient.cs` - 2å¤„
22. `MauiApp/ViewModels/MainViewModel.cs` - 1å¤„
23. âš ï¸ `Infrastructure/Services/OperationStateTracker.cs` - éœ€ç§»é™¤ Obsolete å±æ€§

**ä¿®å¤æŒ‡å—ï¼ˆä¸‹ä¸€ä¸ª PRï¼‰**:

**æ­¥éª¤1: å‡†å¤‡å·¥ä½œ**
```bash
# ç¡®è®¤ ISystemClock å·²æ³¨å†Œ
grep -r "ISystemClock" ZakYip.Singulation.Host/Program.cs

# è·å–å‰©ä½™æ–‡ä»¶åˆ—è¡¨
find . -name "*.cs" | xargs grep -l "DateTime\.\(Now\|UtcNow\)" | grep -v SystemClock
```

**æ­¥éª¤2: æ‰¹é‡é‡æ„æ¨¡å¼**

**æ¨¡å¼A: æœåŠ¡ç±»ï¼ˆéœ€è¦æ„é€ å‡½æ•°æ³¨å…¥ï¼‰**
```csharp
// 1. æ·»åŠ  using
using ZakYip.Singulation.Core.Abstractions;

// 2. æ·»åŠ å­—æ®µ
private readonly ISystemClock _clock;

// 3. æ›´æ–°æ„é€ å‡½æ•°
public MyService(..., ISystemClock clock) {
    _clock = clock;
}

// 4. æ›¿æ¢æ‰€æœ‰ DateTime.Now/UtcNow
DateTime.Now â†’ _clock.Now
DateTime.UtcNow â†’ _clock.UtcNow
```

**æ¨¡å¼B: Record/DTOç±»ï¼ˆé»˜è®¤å€¼åˆå§‹åŒ–ï¼‰**
```csharp
// ä¸èƒ½æ³¨å…¥ï¼Œéœ€è¦è°ƒç”¨æ–¹æä¾›æ—¶é—´
public record MyEvent {
    // ç§»é™¤é»˜è®¤å€¼
    public DateTime TimestampUtc { get; init; }
    
    // æˆ–ä¿ç•™ä¸ºå¯é€‰ï¼Œç”±è°ƒç”¨æ–¹è®¾ç½®
    public DateTime TimestampUtc { get; init; } = default;
}

// è°ƒç”¨æ–¹è´Ÿè´£è®¾ç½®
new MyEvent { TimestampUtc = _clock.UtcNow }
```

**æ¨¡å¼C: é™æ€ç±»/Codecï¼ˆæ— æ³•æ³¨å…¥ï¼Œéœ€è¦ä¼ å‚ï¼‰**
```csharp
// ä½œä¸ºå‚æ•°ä¼ é€’
public SpeedSet Decode(byte[] data, ISystemClock clock) {
    return new SpeedSet(clock.UtcNow, ...);
}
```

**æ­¥éª¤3: é€å±‚å¤„ç†**

**é˜¶æ®µ1: Infrastructure å±‚ (5 æ–‡ä»¶ï¼Œé¢„è®¡ 2-3 å°æ—¶)**
- ä¼˜å…ˆçº§æœ€é«˜ï¼Œå½±å“å…¶ä»–å±‚
- éƒ½æ˜¯æœåŠ¡ç±»ï¼Œä½¿ç”¨æ¨¡å¼A
- æ‰¹é‡å¤„ç†ï¼Œä¸€æ¬¡æäº¤

**é˜¶æ®µ2: Transport å±‚ (2 æ–‡ä»¶ï¼Œé¢„è®¡ 1 å°æ—¶)**
- åˆ›å»ºäº‹ä»¶ï¼Œå½±å“ Core å±‚
- éœ€è¦æ³¨å…¥ ISystemClock
- ä¿®æ”¹äº‹ä»¶åˆ›å»ºä»£ç 

**é˜¶æ®µ3: Core å±‚ (7 æ–‡ä»¶ï¼Œé¢„è®¡ 2 å°æ—¶)**
- DTOs å’Œ Eventsï¼Œä½¿ç”¨æ¨¡å¼B
- ç§»é™¤é»˜è®¤å€¼ï¼Œç”±è°ƒç”¨æ–¹æä¾›
- éœ€è¦æ›´æ–°æ‰€æœ‰è°ƒç”¨æ–¹

**é˜¶æ®µ4: Drivers + Protocol (6 æ–‡ä»¶ï¼Œé¢„è®¡ 2-3 å°æ—¶)**
- Drivers: ä½¿ç”¨æ¨¡å¼Aï¼ˆæ„é€ å‡½æ•°æ³¨å…¥ï¼‰
- Protocol: ä½¿ç”¨æ¨¡å¼Cï¼ˆå‚æ•°ä¼ é€’ï¼‰

**é˜¶æ®µ5: Host å±‚ (4 æ–‡ä»¶ï¼Œé¢„è®¡ 1-2 å°æ—¶)**
- Controllers: æ„é€ å‡½æ•°æ³¨å…¥
- DTOs: ç§»é™¤é»˜è®¤å€¼
- SignalR: æ„é€ å‡½æ•°æ³¨å…¥

**é˜¶æ®µ6: Tests + Others (11 æ–‡ä»¶ï¼Œé¢„è®¡ 2-3 å°æ—¶)**
- Tests: æ³¨å…¥ mock ISystemClock
- MauiApp: å¯é€‰ï¼Œéœ€è¦ç‰¹æ®Šå·¥ä½œè´Ÿè½½
- Benchmarks/Demo: ä½ä¼˜å…ˆçº§

**æ­¥éª¤4: éªŒè¯**
```bash
# ç¡®è®¤æ²¡æœ‰é—æ¼
find . -name "*.cs" | xargs grep -l "DateTime\.\(Now\|UtcNow\)" | grep -v SystemClock | wc -l
# åº”è¯¥è¾“å‡º 0

# æ„å»ºéªŒè¯
dotnet build

# è¿è¡Œæµ‹è¯•
dotnet test
```

**æ­¥éª¤5: æ¸…ç†**
- ç§»é™¤ `OperationStateTracker.cs` ä¸­çš„ `[Obsolete]` å±æ€§
- æ›´æ–° TECHNICAL_DEBT.mdï¼Œæ ‡è®°ä¸ºå®Œæˆ

**å½±å“**:
- å•å…ƒæµ‹è¯•éš¾åº¦å¢åŠ ï¼ˆæ— æ³•æ³¨å…¥æ—¶é—´ï¼‰â†’ å·²è§£å†³ï¼ˆISystemClock å¯æ³¨å…¥ï¼‰
- æ—¶é—´ç›¸å…³é€»è¾‘éš¾ä»¥æµ‹è¯• â†’ å·²è§£å†³
- ä¸ç¬¦åˆä¾èµ–æ³¨å…¥åŸåˆ™ â†’ å·²è§£å†³
- ä»£ç å¯æµ‹è¯•æ€§é™ä½ â†’ å·²æ”¹å–„

**éªŒè¯æ ‡å‡†**:
- [x] ISystemClock æ¥å£å’Œå®ç°å·²åˆ›å»º
- [x] ISystemClock å·²æ³¨å†Œåˆ° DI å®¹å™¨
- [x] ç¤ºä¾‹ä»£ç å·²æ·»åŠ åˆ°ç¼–ç è§„èŒƒ
- [x] å‰10ä¸ªæ–‡ä»¶å·²è¿ç§» (22%)
- [ ] å‰©ä½™38ä¸ªæ–‡ä»¶å¾…è¿ç§» (78%)
- [ ] æ‰€æœ‰æ–°ä»£ç ä½¿ç”¨ ISystemClock
- [ ] æ„å»ºé€šè¿‡ï¼Œæµ‹è¯•é€šè¿‡

**è´£ä»»äºº**: å¾…åˆ†é…ï¼ˆå»ºè®®ç”±åŸ PR ä½œè€…ç»§ç»­å®Œæˆï¼‰  
**é¢„è®¡å®Œæˆæ—¥æœŸ**: 2025-12-15ï¼ˆå¦‚åœ¨ä¸‹ä¸€ä¸ª PR ä¸­å®Œæˆï¼‰

**å…³é”®æç¤º**:
1. **æ‰¹é‡å¤„ç†**: æŒ‰å±‚æ¬¡åˆ†æ‰¹å¤„ç†ï¼Œæ¯æ‰¹ 5-10 ä¸ªæ–‡ä»¶
2. **å…ˆæ˜“åéš¾**: Infrastructure â†’ Transport â†’ Host â†’ Core â†’ Drivers â†’ Protocol â†’ Tests
3. **æµ‹è¯•ä¼˜å…ˆ**: å®Œæˆæ¯æ‰¹åç«‹å³æµ‹è¯•ï¼Œç¡®ä¿ä¸ç ´ååŠŸèƒ½
4. **æäº¤é¢‘ç¹**: æ¯å®Œæˆä¸€æ‰¹å°±æäº¤ï¼Œä¾¿äºå›æ»š
5. **æ–‡æ¡£åŒæ­¥**: æ›´æ–° TECHNICAL_DEBT.md è¿›åº¦

---

## ğŸŸ¡ P2 - ä¸­ä¼˜å…ˆçº§æŠ€æœ¯å€ºåŠ¡ (Medium Priority)

### TD-NEW-003: ApiResponse<T> ç¼ºå°‘ sealed ä¿®é¥°ç¬¦
**çŠ¶æ€**: âœ… å·²å®Œæˆ  
**å®Œæˆæ—¥æœŸ**: 2025-12-15  
**å‘ç°æ—¥æœŸ**: 2025-12-15  
**ä¼˜å…ˆçº§**: P2  
**å½±å“èŒƒå›´**: Host å±‚  
**å·¥ä½œé‡**: 5 åˆ†é’Ÿï¼ˆå®é™…ï¼š2 åˆ†é’Ÿï¼‰

**é—®é¢˜æè¿°**:
`ApiResponse<T>` æ˜¯ä¸€ä¸ªæ³›å‹ record classï¼Œä½†ç¼ºå°‘ `sealed` ä¿®é¥°ç¬¦ï¼Œå¯èƒ½è¢«æ„å¤–ç»§æ‰¿ã€‚

**ä½ç½®**:
- `ZakYip.Singulation.Host/Dto/ApiResponse.cs:11`

**ä¿®å¤æ–¹æ¡ˆ**:
ä¸º `ApiResponse<T>` æ·»åŠ  `sealed` ä¿®é¥°ç¬¦ã€‚

**æ‰§è¡Œç»“æœ**:
- âœ… ApiResponse<T> å·²æ·»åŠ  sealed ä¿®é¥°ç¬¦
- âœ… ä»£ç ç¼–è¯‘é€šè¿‡
- âœ… ç¬¦åˆç¼–ç è§„èŒƒç¬¬ 4 èŠ‚

**è´£ä»»äºº**: GitHub Copilot  
**å®Œæˆæ—¥æœŸ**: 2025-12-15

---

### TD-NEW-004: æŒä¹…åŒ–å­˜å‚¨ç±»ä¸­é‡å¤çš„ Key å¸¸é‡å®šä¹‰
**çŠ¶æ€**: âœ… å·²å®Œæˆ  
**å®Œæˆæ—¥æœŸ**: 2025-12-15  
**å‘ç°æ—¥æœŸ**: 2025-12-15  
**ä¼˜å…ˆçº§**: P2  
**å½±å“èŒƒå›´**: Infrastructure å±‚  
**å·¥ä½œé‡**: 20-30 åˆ†é’Ÿï¼ˆå®é™…ï¼š15 åˆ†é’Ÿï¼‰

**é—®é¢˜æè¿°**:
åœ¨ 6 ä¸ªä¸åŒçš„ LiteDB æŒä¹…åŒ–å­˜å‚¨ç±»ä¸­ï¼Œé‡å¤å®šä¹‰äº†ç›¸åŒçš„å¸¸é‡ `private const string Key = "default";`ã€‚è¿™è¿åäº†ç¼–ç è§„èŒƒç¬¬ 9 èŠ‚çš„"å½±åˆ†èº«é›¶å®¹å¿"åŸåˆ™ã€‚

**ä½ç½®**:
1. `Infrastructure/Transport/LiteDbUpstreamCodecOptionsStore.cs:23`
2. `Infrastructure/Persistence/Vendors/Leadshine/LiteDbLeadshineCabinetIoOptionsStore.cs:20`
3. `Infrastructure/Persistence/LiteDbControllerOptionsStore.cs:22`
4. `Infrastructure/Persistence/LiteDbIoLinkageOptionsStore.cs:20`
5. `Infrastructure/Persistence/LiteDbSpeedLinkageOptionsStore.cs:19`
6. `Infrastructure/Persistence/LiteDbIoStatusMonitorOptionsStore.cs:20`

**ä½ç½®**ï¼ˆå·²ä¿®å¤ï¼‰:
1. âœ… `Infrastructure/Transport/LiteDbUpstreamCodecOptionsStore.cs:23`
2. âœ… `Infrastructure/Persistence/Vendors/Leadshine/LiteDbLeadshineCabinetIoOptionsStore.cs:20`
3. âœ… `Infrastructure/Persistence/LiteDbControllerOptionsStore.cs:22`
4. âœ… `Infrastructure/Persistence/LiteDbIoLinkageOptionsStore.cs:20`
5. âœ… `Infrastructure/Persistence/LiteDbSpeedLinkageOptionsStore.cs:19`
6. âœ… `Infrastructure/Persistence/LiteDbIoStatusMonitorOptionsStore.cs:20`

**ä¿®å¤æ–¹æ¡ˆ**:
åˆ›å»ºå…±äº«å¸¸é‡ç±» `LiteDbConstants`ï¼š

```csharp
// æ–°å»º: Infrastructure/Persistence/LiteDbConstants.cs
namespace ZakYip.Singulation.Infrastructure.Persistence;

/// <summary>
/// LiteDB æŒä¹…åŒ–å­˜å‚¨å¸¸é‡å®šä¹‰
/// </summary>
internal static class LiteDbConstants
{
    /// <summary>
    /// å•ä¾‹é…ç½®çš„é»˜è®¤é”®å
    /// </summary>
    public const string DefaultKey = "default";
}

// å„ä¸ªå­˜å‚¨ç±»ä¸­ä½¿ç”¨
private const string Key = LiteDbConstants.DefaultKey;  // âœ… å¼•ç”¨å…±äº«å¸¸é‡
```

**æ‰§è¡Œç»“æœ**:
- âœ… åˆ›å»º LiteDbConstants ç±»
- âœ… æ›´æ–°æ‰€æœ‰ 6 ä¸ªå­˜å‚¨ç±»å¼•ç”¨
- âœ… ä»£ç ç¼–è¯‘é€šè¿‡
- âœ… æ¶ˆé™¤äº† 6 å¤„é‡å¤å¸¸é‡å®šä¹‰
- âœ… ç¬¦åˆç¼–ç è§„èŒƒç¬¬ 9 èŠ‚

**éªŒè¯**:
```bash
# éªŒè¯æ‰€æœ‰æ–‡ä»¶éƒ½ä½¿ç”¨å…±äº«å¸¸é‡
$ grep "LiteDbConstants.DefaultKey" Infrastructure/**/*.cs
# è¾“å‡º: 6 å¤„å¼•ç”¨ï¼Œå…¨éƒ¨æ­£ç¡®
```

**è´£ä»»äºº**: GitHub Copilot  
**å®Œæˆæ—¥æœŸ**: 2025-12-15

---

### TD-NEW-005: å¤§é‡å±æ€§ä½¿ç”¨ get; set; è€Œé init
**çŠ¶æ€**: â³ å¾…å¤„ç†  
**å‘ç°æ—¥æœŸ**: 2025-12-15  
**ä¼˜å…ˆçº§**: P2  
**å½±å“èŒƒå›´**: å¤šä¸ªå±‚  
**é¢„è®¡å·¥ä½œé‡**: 8-12 å°æ—¶ï¼ˆåˆ†é˜¶æ®µå®Œæˆï¼‰

**é—®é¢˜æè¿°**:
é¡¹ç›®ä¸­æœ‰ 261 å¤„å±æ€§ä½¿ç”¨ `{ get; set; }` è®¿é—®å™¨ï¼Œè€Œéæ¨èçš„ `{ get; init; }` æˆ– `required` + `init`ã€‚è¿åäº†ç¼–ç è§„èŒƒç¬¬ 1 èŠ‚ã€‚

**ç»Ÿè®¡åˆ†æ**:
- æ€»æ•°: 261 å¤„
- Entity ç±» (ORM): ~40% (å¯æ¥å—ï¼ŒORM æ¡†æ¶è¦æ±‚)
- DTO ç±»: ~30% (åº”æ”¹ä¸º init)
- é…ç½®ç±»: ~20% (åº”æ”¹ä¸º required + init)
- å…¶ä»–: ~10%

**ä¿®å¤ç­–ç•¥**ï¼ˆåˆ†é˜¶æ®µï¼‰:
**é˜¶æ®µ 1ï¼ˆæœ¬å‘¨ï¼‰**: ä¿®å¤æ–°å»ºçš„ DTO å’Œé…ç½®ç±»
- å®¡æŸ¥æœ€è¿‘ 3 ä¸ªæœˆæ–°å¢çš„ç±»
- åº”ç”¨ required + init æ¨¡å¼

**é˜¶æ®µ 2ï¼ˆä¸‹å‘¨ï¼‰**: ä¿®å¤ Host å±‚ DTO
- `Host/Dto/*.cs` æ–‡ä»¶
- `Host/Controllers/*Request.cs` æ–‡ä»¶

**é˜¶æ®µ 3ï¼ˆåç»­ï¼‰**: æŒç»­æ”¹è¿›
- æ¯ä¸ª PR ä¿®å¤ 5-10 ä¸ªç±»
- åœ¨ Code Review ä¸­æ£€æŸ¥æ–°ä»£ç 

**ç¤ºä¾‹ä¿®å¤**:
```csharp
// âŒ ä¿®å¤å‰
public class UserDto
{
    public long Id { get; set; }
    public string Name { get; set; } = string.Empty;
}

// âœ… ä¿®å¤å
public sealed record class UserDto
{
    public required long Id { get; init; }
    public required string Name { get; init; }
}
```

**å½±å“**:
- é™ä½ä¸å¯å˜æ€§
- å¢åŠ è¿è¡Œæ—¶é”™è¯¯é£é™©
- ä¸ç¬¦åˆç°ä»£ C# æœ€ä½³å®è·µ

**éªŒè¯æ ‡å‡†**:
- [ ] è¯†åˆ«å¹¶åˆ†ç±»æ‰€æœ‰ 261 å¤„ä½¿ç”¨
- [ ] é˜¶æ®µ 1 å®Œæˆï¼šæ–°å»ºç±»å·²ä¿®å¤
- [ ] é˜¶æ®µ 2 å®Œæˆï¼šHost å±‚ DTO å·²ä¿®å¤
- [ ] ä»£ç ç¼–è¯‘é€šè¿‡
- [ ] æ‰€æœ‰æµ‹è¯•é€šè¿‡

**è´£ä»»äºº**: å¾…åˆ†é…  
**ç›®æ ‡å®Œæˆæ—¥æœŸ**: 2026-01-31ï¼ˆåˆ†é˜¶æ®µå®Œæˆï¼‰

---

### TD-001: SafeExecuteæ¨¡å¼é‡å¤å®ç°
**çŠ¶æ€**: âœ… å·²å®Œæˆ  
**å®Œæˆæ—¥æœŸ**: 2025-12-07  
**å‘ç°æ—¥æœŸ**: 2025-12-06  
**ä¼˜å…ˆçº§**: P1  
**å½±å“èŒƒå›´**: Infrastructure å±‚  
**å·¥ä½œé‡**: 4-6å°æ—¶ (å®é™…: 3å°æ—¶)

**é—®é¢˜æè¿°**:
SafeExecuteæ¨¡å¼åœ¨3ä¸ªä¸åŒçš„ç±»ä¸­æœ‰é‡å¤å®ç°ï¼š
1. `CabinetIsolator.cs` - ä¸»è¦å®ç°ï¼ˆæ¨èä¿ç•™ï¼‰
2. `SafeOperationIsolator.cs` - å·²æ ‡è®°ä¸ºåºŸå¼ƒï¼Œä½†ä»åœ¨ä½¿ç”¨
3. `SafeOperationHelper.cs` - Swaggerä¸“ç”¨ï¼Œå¯ä»¥æ•´åˆ

å½“å‰æœ‰44å¤„SafeExecuteæ–¹æ³•å®ç°ï¼Œç›®æ ‡æ˜¯â‰¤2å¤„ã€‚

**å½±å“**:
- ç»´æŠ¤æˆæœ¬é«˜ï¼Œä¿®æ”¹éœ€è¦åŒæ­¥å¤šå¤„
- è¡Œä¸ºå¯èƒ½ä¸ä¸€è‡´
- è¿åDRYåŸåˆ™

**ä¿®å¤æ–¹æ¡ˆ**:
1. âœ… å®Œå…¨ç§»é™¤ `SafeOperationIsolator` çš„æ‰€æœ‰ä½¿ç”¨
2. âœ… å°† `SafeOperationHelper` é‡æ„ä¸º ICabinetIsolator çš„è–„åŒ…è£…å™¨
3. âœ… æ›´æ–°æ‰€æœ‰è°ƒç”¨ç‚¹
4. âœ… æ·»åŠ è¿ç§»æŒ‡å—æ–‡æ¡£ï¼ˆåœ¨ä»£ç æ³¨é‡Šä¸­ï¼‰

**æ‰§è¡Œç»“æœ**:
- âœ… SafeOperationIsolator ç±»å·²å®Œå…¨ç§»é™¤
- âœ… SafeOperationHelper æ›´æ–°ä¸ºè–„åŒ…è£…å™¨ï¼Œå¢åŠ äº†å¯¹ ICabinetIsolator çš„æ”¯æŒ
- âœ… æµ‹è¯•ç±»è¿ç§»åˆ°ä½¿ç”¨ ICabinetIsolator/CabinetIsolator
- âœ… åˆ›å»ºäº† FakeRealtimeNotifier æµ‹è¯•è¾…åŠ©ç±»
- âœ… SafeExecute å®ç°ä» 44 å¤„å‡å°‘åˆ° 9 å¤„ï¼ˆ6 ä¸ªåœ¨ CabinetIsolator + 3 ä¸ªåœ¨ SafeOperationHelperï¼‰

**ç›¸å…³æ–‡ä»¶**:
- ~~`ZakYip.Singulation.Infrastructure/Runtime/SafeOperationIsolator.cs`~~ - å·²åˆ é™¤
- `ZakYip.Singulation.Infrastructure/Cabinet/CabinetIsolator.cs`
- `ZakYip.Singulation.Host/SwaggerOptions/SafeOperationHelper.cs` - å·²æ›´æ–°
- `ZakYip.Singulation.Tests/SafeOperationIsolatorTests.cs` - å·²è¿ç§»
- `ZakYip.Singulation.Tests/TestHelpers/FakeRealtimeNotifier.cs` - æ–°å»º

**éªŒè¯æ ‡å‡†**:
- [x] SafeOperationIsolator å®Œå…¨ç§»é™¤
- [x] SafeOperationHelper ä½¿ç”¨ ICabinetIsolator
- [x] æ‰€æœ‰è°ƒç”¨ç‚¹æ›´æ–°å®Œæˆ
- [x] å•å…ƒæµ‹è¯•é€šè¿‡
- [x] è¿è¡Œ `tools/check-duplication.sh` æ˜¾ç¤º 9 å¤„ï¼ˆå¯æ¥å—ï¼‰

**è´£ä»»äºº**: GitHub Copilot  
**å®Œæˆæ—¥æœŸ**: 2025-12-07

---

### TD-002: å¼‚å¸¸å¤„ç†è¿‡äºå®½æ³›
**çŠ¶æ€**: â³ å¾…å¤„ç†  
**å‘ç°æ—¥æœŸ**: 2025-12-06  
**ä¼˜å…ˆçº§**: P1  
**å½±å“èŒƒå›´**: å¤šä¸ªå±‚  
**é¢„è®¡å·¥ä½œé‡**: 8-12å°æ—¶

**é—®é¢˜æè¿°**:
é¡¹ç›®ä¸­æœ‰227å¤„æ•è·é€šç”¨ `Exception` çš„ä»£ç ï¼Œè¿™å¯èƒ½éšè—å…·ä½“çš„é”™è¯¯ç±»å‹ï¼Œä½¿è°ƒè¯•å›°éš¾ã€‚

**çƒ­ç‚¹æ–‡ä»¶**:
1. `LeadshineLtdmcBusAdapter.cs` - 11å¤„
2. `WindowsNetworkAdapterManager.cs` - 12å¤„
3. `WindowsFirewallManager.cs` - 6å¤„
4. `IoStatusService.cs` - 4å¤„

**å½±å“**:
- éš¾ä»¥å®šä½å…·ä½“é”™è¯¯åŸå› 
- å¯èƒ½åå™¬ä¸¥é‡å¼‚å¸¸ï¼ˆå¦‚ OutOfMemoryExceptionï¼‰
- é™ä½ä»£ç å¯ç»´æŠ¤æ€§

**ä¿®å¤æ–¹æ¡ˆ**:
é˜¶æ®µ1ï¼ˆæœ¬å‘¨ï¼‰ï¼šä¿®å¤çƒ­ç‚¹æ–‡ä»¶ï¼ˆå‰10ä¸ªæ–‡ä»¶ï¼‰
- åŒºåˆ†å…·ä½“å¼‚å¸¸ç±»å‹ï¼ˆDllNotFoundException, SEHException, TimeoutExceptionç­‰ï¼‰
- ä¸ºå¿…é¡»æ•è·é€šç”¨Exceptionçš„åœ°æ–¹æ·»åŠ è¯¦ç»†æ³¨é‡Š
- ä½¿ç”¨ when å­å¥æ’é™¤ä¸¥é‡å¼‚å¸¸

é˜¶æ®µ2ï¼ˆä¸‹å‘¨ï¼‰ï¼šæŒç»­æ”¹è¿›
- æ¯ä¸ªPRä¿®å¤5-10å¤„
- å»ºç«‹ä»£ç å®¡æŸ¥æ£€æŸ¥æ¸…å•

**ç›¸å…³æ–‡æ¡£**:
- `docs/EXCEPTION_HANDLING_BEST_PRACTICES.md`
- `QUICK_FIX_GUIDE.md`

**éªŒè¯æ ‡å‡†**:
- [ ] çƒ­ç‚¹æ–‡ä»¶å¼‚å¸¸å¤„ç†æ”¹è¿›å®Œæˆ
- [ ] é€šç”¨Exceptionæ•°é‡é™è‡³â‰¤200
- [ ] æ·»åŠ äº†å¿…è¦çš„æ³¨é‡Šè¯´æ˜
- [ ] ä»£ç å®¡æŸ¥é€šè¿‡

**è´£ä»»äºº**: å¾…åˆ†é…  
**ç›®æ ‡å®Œæˆæ—¥æœŸ**: 2025-12-27

---

## ğŸŸ¡ P2 - ä¸­ä¼˜å…ˆçº§æŠ€æœ¯å€ºåŠ¡ (Medium Priority)

### TD-003: èµ„æºç®¡ç† - å¯èƒ½çš„èµ„æºæ³„æ¼
**çŠ¶æ€**: â³ å¾…å¤„ç†  
**å‘ç°æ—¥æœŸ**: 2025-12-06  
**ä¼˜å…ˆçº§**: P2  
**å½±å“èŒƒå›´**: Transport, Infrastructure å±‚  
**é¢„è®¡å·¥ä½œé‡**: 4-6å°æ—¶

**é—®é¢˜æè¿°**:
å‘ç°35å¤„åˆ›å»º Stream/Connection ä½†å¯èƒ½æœªä½¿ç”¨ `using` è¯­å¥çš„ä»£ç ï¼Œå¯èƒ½å¯¼è‡´èµ„æºæ³„æ¼ã€‚

**ä¸»è¦é—®é¢˜åŒºåŸŸ**:
- TCPè¿æ¥ç®¡ç†ï¼ˆTouchClientByteTransport, TouchServerByteTransportï¼‰
- æ–‡ä»¶æµæ“ä½œ
- WMIå¯¹è±¡ä½¿ç”¨

**å½±å“**:
- å†…å­˜æ³„æ¼é£é™©
- æ–‡ä»¶å¥æŸ„æœªå…³é—­
- ç½‘ç»œè¿æ¥æœªé‡Šæ”¾
- é•¿æ—¶é—´è¿è¡Œåå¯èƒ½èµ„æºè€—å°½

**ä¿®å¤æ–¹æ¡ˆ**:
1. å®¡æŸ¥æ‰€æœ‰ Stream/Connection åˆ›å»ºç‚¹
2. ç¡®ä¿ä½¿ç”¨ `using` å£°æ˜æˆ– `await using`
3. å¯¹äºæ— æ³•ä½¿ç”¨usingçš„åœºæ™¯ï¼Œç¡®ä¿åœ¨ finally ä¸­é‡Šæ”¾
4. æ·»åŠ èµ„æºç®¡ç†æœ€ä½³å®è·µåˆ°ç¼–ç è§„èŒƒ

**éªŒè¯æ ‡å‡†**:
- [ ] æ‰€æœ‰Streamä½¿ç”¨usingæˆ–await using
- [ ] æ‰€æœ‰Connectionæ­£ç¡®é‡Šæ”¾
- [ ] æ·»åŠ èµ„æºç®¡ç†æ£€æŸ¥åˆ°pre-commit hook
- [ ] é•¿æ—¶é—´è¿è¡Œæµ‹è¯•ï¼ˆ24å°æ—¶ï¼‰æ— å†…å­˜æ³„æ¼

**è´£ä»»äºº**: å¾…åˆ†é…  
**ç›®æ ‡å®Œæˆæ—¥æœŸ**: 2026-01-10

---

### TD-004: å¹¶å‘å®‰å…¨ - lockä½¿ç”¨å®¡æŸ¥
**çŠ¶æ€**: â³ å¾…å¤„ç†  
**å‘ç°æ—¥æœŸ**: 2025-12-06  
**ä¼˜å…ˆçº§**: P2  
**å½±å“èŒƒå›´**: å¤šä¸ªå±‚  
**é¢„è®¡å·¥ä½œé‡**: 6-8å°æ—¶

**é—®é¢˜æè¿°**:
å‘ç°72å¤„ä½¿ç”¨ `lock` è¯­å¥ï¼Œéœ€è¦å®¡æŸ¥æ˜¯å¦å­˜åœ¨æ­»é”é£é™©ã€é”ç²’åº¦æ˜¯å¦åˆç†ã€‚

**å®¡æŸ¥é‡ç‚¹**:
- é”å®šé¡ºåºä¸€è‡´æ€§
- é”çš„èŒƒå›´æœ€å°åŒ–
- å¼‚æ­¥æ–¹æ³•ä¸­åº”ä½¿ç”¨ SemaphoreSlim è€Œé lock
- é¿å…åœ¨é”å†…æ‰§è¡Œè€—æ—¶æ“ä½œ

**å½±å“**:
- æ½œåœ¨çš„æ­»é”é£é™©
- æ€§èƒ½ç“¶é¢ˆï¼ˆé”ç²’åº¦è¿‡å¤§ï¼‰
- å¼‚æ­¥æ–¹æ³•ä¸­ä½¿ç”¨lockå¯èƒ½å¯¼è‡´é—®é¢˜

**ä¿®å¤æ–¹æ¡ˆ**:
1. å®¡æŸ¥æ‰€æœ‰lockä½¿ç”¨ï¼Œè®°å½•é”å®šé¡ºåº
2. è¯†åˆ«å¯ä»¥å‡å°é”èŒƒå›´çš„ä½ç½®
3. å¼‚æ­¥æ–¹æ³•æ”¹ç”¨ SemaphoreSlim
4. æ·»åŠ æ­»é”æ£€æµ‹å·¥å…·

**ç›¸å…³æ–‡ä»¶**:
- `LeadshineLtdmcBusAdapter.cs`
- `AxisController.cs`
- å„ç§Serviceç±»

**éªŒè¯æ ‡å‡†**:
- [ ] æ‰€æœ‰lockä½¿ç”¨å·²å®¡æŸ¥
- [ ] è®°å½•é”å®šé¡ºåºæ–‡æ¡£
- [ ] å¼‚æ­¥æ–¹æ³•ä½¿ç”¨SemaphoreSlim
- [ ] å‹åŠ›æµ‹è¯•æ— æ­»é”

**è´£ä»»äºº**: å¾…åˆ†é…  
**ç›®æ ‡å®Œæˆæ—¥æœŸ**: 2026-01-17

---

### TD-005: å¾ªç¯ä¸­åˆ›å»ºå¯¹è±¡ - æ€§èƒ½ä¼˜åŒ–
**çŠ¶æ€**: â³ å¾…å¤„ç†  
**å‘ç°æ—¥æœŸ**: 2025-12-06  
**ä¼˜å…ˆçº§**: P2  
**å½±å“èŒƒå›´**: å¤šä¸ªå±‚  
**é¢„è®¡å·¥ä½œé‡**: 4-6å°æ—¶

**é—®é¢˜æè¿°**:
å‘ç°86å¤„åœ¨å¾ªç¯ä¸­åˆ›å»ºå¯¹è±¡çš„ä»£ç ï¼Œå¯èƒ½å½±å“æ€§èƒ½å’Œå¢åŠ GCå‹åŠ›ã€‚

**å½±å“**:
- å¢åŠ GCå‹åŠ›
- å†…å­˜åˆ†é…çƒ­ç‚¹
- é«˜é¢‘æ“ä½œæ€§èƒ½ä¸‹é™

**ä¿®å¤æ–¹æ¡ˆ**:
1. è¯†åˆ«æ€§èƒ½å…³é”®è·¯å¾„ä¸Šçš„å¾ªç¯
2. ä½¿ç”¨å¯¹è±¡é‡ç”¨æˆ–å¯¹è±¡æ± ï¼ˆArrayPoolï¼‰
3. å¯¹äºå°å¯¹è±¡è€ƒè™‘ä½¿ç”¨ stackalloc æˆ– Span<T>
4. è¿›è¡Œæ€§èƒ½åŸºå‡†æµ‹è¯•å¯¹æ¯”

**å·²å®Œæˆéƒ¨åˆ†**:
- âœ… IoStatusService å·²ä½¿ç”¨ ArrayPool

**å¾…ä¼˜åŒ–ä½ç½®**:
- å…¶ä»–é«˜é¢‘å¾ªç¯ä»£ç 

**éªŒè¯æ ‡å‡†**:
- [ ] æ€§èƒ½å…³é”®è·¯å¾„ä¼˜åŒ–å®Œæˆ
- [ ] å¾ªç¯åˆ›å»ºå¯¹è±¡æ•°é‡é™è‡³â‰¤40
- [ ] æ€§èƒ½åŸºå‡†æµ‹è¯•æ˜¾ç¤ºæ”¹è¿›
- [ ] GCå‹åŠ›é™ä½

**è´£ä»»äºº**: å¾…åˆ†é…  
**ç›®æ ‡å®Œæˆæ—¥æœŸ**: 2026-01-24

---

## ğŸŸ¢ P3 - ä½ä¼˜å…ˆçº§æŠ€æœ¯å€ºåŠ¡ (Low Priority)

### TD-NEW-006: MauiApp ä¸­ä½¿ç”¨ async void
**çŠ¶æ€**: â³ å¾…å¤„ç†ï¼ˆå¯æ¥å—çš„ä¾‹å¤–æƒ…å†µï¼‰  
**å‘ç°æ—¥æœŸ**: 2025-12-15  
**ä¼˜å…ˆçº§**: P3  
**å½±å“èŒƒå›´**: MauiApp å±‚  
**é¢„è®¡å·¥ä½œé‡**: 4-6 å°æ—¶ï¼ˆå¯é€‰æ”¹è¿›ï¼‰

**é—®é¢˜æè¿°**:
`ZakYip.Singulation.MauiApp` é¡¹ç›®ä¸­æœ‰ 8 ä¸ª `async void` æ–¹æ³•ï¼Œè¿åäº†ç¼–ç è§„èŒƒç¬¬ 7.2 èŠ‚çš„å¼‚æ­¥ç¼–ç¨‹æœ€ä½³å®è·µã€‚

**ä½ç½®**:
1. `MauiApp/Services/SignalRClientFactory.cs:133` - OnLatencyTimerElapsed
2. `MauiApp/ViewModels/SingulationHomeViewModel.cs:90` - OnSearch
3. `MauiApp/ViewModels/SingulationHomeViewModel.cs:105` - OnRefreshController
4. `MauiApp/ViewModels/SingulationHomeViewModel.cs:114` - OnSafetyCommand
5. `MauiApp/ViewModels/SingulationHomeViewModel.cs:153` - OnAxisSpeedSetting
6. `MauiApp/ViewModels/SingulationHomeViewModel.cs:199` - OnSeparate
7. `MauiApp/AppShell.xaml.cs:11` - OnNavigating
8. `MauiApp/AppShell.xaml.cs:22` - OnNavigated

**ç‰¹æ®Šè¯´æ˜ - âš ï¸ MAUI æ¡†æ¶çš„è®¾è®¡é™åˆ¶**:
è¿™äº›æ–¹æ³•éƒ½åœ¨ MAUI UI ä¸Šä¸‹æ–‡ä¸­ï¼Œæ˜¯æ¡†æ¶è¦æ±‚çš„æ¨¡å¼ï¼š
1. **ViewModel å‘½ä»¤å¤„ç†**: MAUI çš„ `ICommand` ç»‘å®šè¦æ±‚ä½¿ç”¨ `async void`
2. **äº‹ä»¶å¤„ç†**: Shell å¯¼èˆªäº‹ä»¶å¿…é¡»ä½¿ç”¨ `async void`
3. **æ‰€æœ‰æ–¹æ³•éƒ½æœ‰å¼‚å¸¸å¤„ç†**: é˜²æ­¢å¼‚å¸¸å¯¼è‡´åº”ç”¨å´©æºƒ
4. **ä»…é™ UI å±‚**: ä¸å½±å“æœåŠ¡å™¨ç«¯æˆ–æ ¸å¿ƒä¸šåŠ¡é€»è¾‘

**è¯„ä¼°ç»“æœ**: âœ… å¯æ¥å—çš„ä¾‹å¤–æƒ…å†µ
- MAUI æ¡†æ¶çš„è®¾è®¡é™åˆ¶ï¼Œæ— æ³•é¿å…
- æ‰€æœ‰æ–¹æ³•éƒ½åœ¨ UI å±‚ï¼Œæœ‰å®Œå–„çš„å¼‚å¸¸å¤„ç†
- ä¸ä¼šå½±å“å…¶ä»–å±‚çš„ä»£ç è´¨é‡

**å¯é€‰æ”¹è¿›æ–¹æ¡ˆ**ï¼ˆå¦‚æœå†³å®šæ”¹è¿›ï¼‰:
ä½¿ç”¨ CommunityToolkit.Mvvm çš„ `IAsyncRelayCommand`ï¼š

```csharp
// å½“å‰æ¨¡å¼
private async void OnSearch()
{
    try {
        await SearchAsync();
    }
    catch (Exception ex) {
        // å¤„ç†å¼‚å¸¸
    }
}

// æ”¹è¿›æ¨¡å¼ï¼ˆä½¿ç”¨ IAsyncRelayCommandï¼‰
[RelayCommand]
private async Task SearchAsync()
{
    // å¼‚å¸¸å¤„ç†ç”±æ¡†æ¶ç®¡ç†
    await PerformSearchAsync();
}
```

**å½±å“**:
- å¯¹åº”ç”¨ç¨³å®šæ€§æ— å½±å“ï¼ˆå·²æœ‰å¼‚å¸¸å¤„ç†ï¼‰
- å¯¹å…¶ä»–å±‚ä»£ç æ— å½±å“
- ç¬¦åˆ MAUI æ¡†æ¶çš„è®¾è®¡æ¨¡å¼

**ä¿®å¤æ–¹æ¡ˆ**ï¼ˆå¯é€‰ï¼‰:
1. åœ¨ç¼–ç è§„èŒƒä¸­æ·»åŠ  MAUI ä¾‹å¤–è¯´æ˜
2. è€ƒè™‘ä½¿ç”¨ CommunityToolkit.Mvvm çš„ IAsyncRelayCommandï¼ˆéœ€è¦é‡æ„ï¼‰
3. ç¡®ä¿æ‰€æœ‰ async void éƒ½æœ‰å®Œå–„çš„å¼‚å¸¸å¤„ç†

**éªŒè¯æ ‡å‡†**:
- [ ] åœ¨ copilot-instructions.md ä¸­æ–‡æ¡£åŒ– MAUI ä¾‹å¤–æƒ…å†µ
- [ ] ç¡®è®¤æ‰€æœ‰ async void æ–¹æ³•éƒ½æœ‰å¼‚å¸¸å¤„ç†
- [ ] ï¼ˆå¯é€‰ï¼‰è¯„ä¼°ä½¿ç”¨ CommunityToolkit.Mvvm çš„å¯è¡Œæ€§

**è´£ä»»äºº**: å¾…åˆ†é…  
**ç›®æ ‡å®Œæˆæ—¥æœŸ**: 2026-02-28ï¼ˆä½ä¼˜å…ˆçº§ï¼Œå¯é€‰æ”¹è¿›ï¼‰

---

### TD-006: ä»£ç æ³¨é‡Šå’Œæ–‡æ¡£å®Œå–„
**çŠ¶æ€**: â³ å¾…å¤„ç†  
**å‘ç°æ—¥æœŸ**: 2025-12-06  
**ä¼˜å…ˆçº§**: P3  
**å½±å“èŒƒå›´**: æ‰€æœ‰å±‚  
**é¢„è®¡å·¥ä½œé‡**: æŒç»­è¿›è¡Œ

**é—®é¢˜æè¿°**:
è™½ç„¶ä¸»è¦æ–‡æ¡£å®Œå–„ï¼Œä½†ä»£ç å†…æ³¨é‡Šè¦†ç›–ä¸å…¨ï¼Œç‰¹åˆ«æ˜¯å¤æ‚ç®—æ³•å’Œä¸šåŠ¡é€»è¾‘éƒ¨åˆ†ã€‚

**å½±å“**:
- æ–°å¼€å‘äººå‘˜ä¸Šæ‰‹å›°éš¾
- å¤æ‚é€»è¾‘éš¾ä»¥ç†è§£
- ç»´æŠ¤æˆæœ¬å¢åŠ 

**ä¿®å¤æ–¹æ¡ˆ**:
1. ä¸ºæ‰€æœ‰å…¬å…±APIæ·»åŠ XMLæ–‡æ¡£æ³¨é‡Š
2. ä¸ºå¤æ‚ç®—æ³•æ·»åŠ è¯´æ˜æ³¨é‡Š
3. ä¸ºå…³é”®ä¸šåŠ¡é€»è¾‘æ·»åŠ æ³¨é‡Š
4. å»ºç«‹æ³¨é‡Šè§„èŒƒ

**éªŒè¯æ ‡å‡†**:
- [ ] æ‰€æœ‰å…¬å…±APIæœ‰XMLæ³¨é‡Š
- [ ] å¤æ‚ç®—æ³•æœ‰è¯´æ˜
- [ ] ä»£ç å®¡æŸ¥æ£€æŸ¥æ³¨é‡Šè´¨é‡

**è´£ä»»äºº**: å…¨ä½“å›¢é˜Ÿæˆå‘˜  
**ç›®æ ‡å®Œæˆæ—¥æœŸ**: æŒç»­æ”¹è¿›

---

### TD-007: æ—¥å¿—è®°å½•ä¸è§„èŒƒ
**çŠ¶æ€**: â³ å¾…å¤„ç†  
**å‘ç°æ—¥æœŸ**: 2025-12-06  
**ä¼˜å…ˆçº§**: P3  
**å½±å“èŒƒå›´**: æ‰€æœ‰å±‚  
**é¢„è®¡å·¥ä½œé‡**: 4-6å°æ—¶

**é—®é¢˜æè¿°**:
æ—¥å¿—çº§åˆ«ä½¿ç”¨ä¸ç»Ÿä¸€ï¼Œé«˜é¢‘æ“ä½œç¼ºå°‘é‡‡æ ·ï¼Œéƒ¨åˆ†é‡è¦æ“ä½œç¼ºå°‘æ—¥å¿—ã€‚

**å½±å“**:
- æ—¥å¿—æ–‡ä»¶è¿‡å¤§
- æ€§èƒ½å¼€é”€
- é‡è¦ä¿¡æ¯è¢«æ·¹æ²¡
- è°ƒè¯•å›°éš¾

**ä¿®å¤æ–¹æ¡ˆ**:
1. ç»Ÿä¸€æ—¥å¿—çº§åˆ«æ ‡å‡†ï¼ˆDebug/Info/Warning/Error/Criticalï¼‰
2. ä¸ºé«˜é¢‘æ“ä½œå®æ–½æ—¥å¿—é‡‡æ ·ç­–ç•¥
3. æ·»åŠ ç»“æ„åŒ–æ—¥å¿—ï¼ˆä½¿ç”¨ LoggerMessageï¼‰
4. ä¸ºå…³é”®ä¸šåŠ¡æ“ä½œæ·»åŠ æ—¥å¿—

**éªŒè¯æ ‡å‡†**:
- [ ] æ—¥å¿—çº§åˆ«ä½¿ç”¨ç»Ÿä¸€
- [ ] é«˜é¢‘æ“ä½œæœ‰é‡‡æ ·
- [ ] å…³é”®æ“ä½œæœ‰æ—¥å¿—
- [ ] æ—¥å¿—æ€§èƒ½å¼€é”€å¯æ¥å—

**è´£ä»»äºº**: å¾…åˆ†é…  
**ç›®æ ‡å®Œæˆæ—¥æœŸ**: 2026-02-07

---

### TD-008: æµ‹è¯•è¦†ç›–ç‡ä¸è¶³
**çŠ¶æ€**: â³ å¾…å¤„ç†  
**å‘ç°æ—¥æœŸ**: 2025-12-06  
**ä¼˜å…ˆçº§**: P3  
**å½±å“èŒƒå›´**: Core, Infrastructure å±‚  
**é¢„è®¡å·¥ä½œé‡**: 12-16å°æ—¶

**é—®é¢˜æè¿°**:
è™½ç„¶æœ‰93%çš„æµ‹è¯•é€šè¿‡ç‡ï¼Œä½†æŸäº›æ ¸å¿ƒåŠŸèƒ½çš„å•å…ƒæµ‹è¯•è¦†ç›–ç‡ä¸è¶³80%ç›®æ ‡ã€‚

**å½“å‰çŠ¶æ€**:
- æ€»æµ‹è¯•æ•°: 184ä¸ª
- é€šè¿‡: 171ä¸ª (93%)
- å¤±è´¥: 13ä¸ªï¼ˆå› ç¼ºå°‘ç¡¬ä»¶é©±åŠ¨ï¼‰

**éœ€è¦æ”¹è¿›**:
- Coreå±‚å•å…ƒæµ‹è¯•è¦†ç›–ç‡ < 80%
- Infrastructureå±‚å•å…ƒæµ‹è¯•è¦†ç›–ç‡ < 70%
- ç¼ºå°‘ç«¯åˆ°ç«¯ä¸šåŠ¡æµç¨‹æµ‹è¯•

**ä¿®å¤æ–¹æ¡ˆ**:
1. è¡¥å……æ ¸å¿ƒåŠŸèƒ½å•å…ƒæµ‹è¯•
2. æ·»åŠ è¾¹ç•Œæ¡ä»¶æµ‹è¯•
3. æ·»åŠ å¼‚å¸¸å¤„ç†æµ‹è¯•
4. è¡¥å……ç«¯åˆ°ç«¯æµ‹è¯•

**éªŒè¯æ ‡å‡†**:
- [ ] Coreå±‚è¦†ç›–ç‡ â‰¥ 80%
- [ ] Infrastructureå±‚è¦†ç›–ç‡ â‰¥ 70%
- [ ] æ·»åŠ è‡³å°‘10ä¸ªç«¯åˆ°ç«¯æµ‹è¯•
- [ ] æ‰€æœ‰æ–°ä»£ç æœ‰æµ‹è¯•

**è´£ä»»äºº**: å¾…åˆ†é…  
**ç›®æ ‡å®Œæˆæ—¥æœŸ**: 2026-02-28

---

## âœ… å·²å®Œæˆçš„æŠ€æœ¯å€ºåŠ¡ (Completed)

### TD-DONE-003: SafeExecuteæ¨¡å¼é‡å¤å®ç°è¯¦ç»†æ¸…ç†æŠ¥å‘Š
**çŠ¶æ€**: âœ… å·²å®Œæˆ  
**å®Œæˆæ—¥æœŸ**: 2025-12-07  
**ä¼˜å…ˆçº§**: P1  
**è´Ÿè´£äºº**: Copilot

**é—®é¢˜æè¿°**:
SafeExecute æ¨¡å¼åœ¨ 3 ä¸ªä¸åŒçš„ç±»ä¸­æœ‰é‡å¤å®ç°ï¼Œåˆå§‹çŠ¶æ€æœ‰ 44 å¤„ SafeExecute å®ç°ã€‚

**æ‰§è¡Œçš„æ“ä½œ**:

1. **ç§»é™¤ SafeOperationIsolator ç±»**
   - æ–‡ä»¶ï¼š`ZakYip.Singulation.Infrastructure/Runtime/SafeOperationIsolator.cs`
   - çŠ¶æ€ï¼šå·²å®Œå…¨åˆ é™¤
   - åŸå› ï¼šè¯¥ç±»å·²æ ‡è®°ä¸º Obsoleteï¼ŒåŠŸèƒ½å·²è¢« CabinetIsolator æ›¿ä»£

2. **æ›´æ–° SafeOperationHelper**
   - æ–‡ä»¶ï¼š`ZakYip.Singulation.Host/SwaggerOptions/SafeOperationHelper.cs`
   - æ”¹è¿›ï¼šæ·»åŠ äº†å¯¹ ICabinetIsolator çš„æ”¯æŒï¼Œæˆä¸ºè–„åŒ…è£…å™¨
   - ä¿ç•™åŸæœ‰é™æ€æ–¹æ³•ï¼Œå› ä¸º Swagger é…ç½®åœºæ™¯æ²¡æœ‰ DI ä¸Šä¸‹æ–‡

3. **è¿ç§»æµ‹è¯•**
   - æ–‡ä»¶ï¼š`ZakYip.Singulation.Tests/SafeOperationIsolatorTests.cs`
   - æ”¹è¿›ï¼šä»ä½¿ç”¨ SafeOperationIsolator è¿ç§»åˆ°ä½¿ç”¨ ICabinetIsolator/CabinetIsolator
   - åˆ›å»ºäº† FakeRealtimeNotifier æµ‹è¯•è¾…åŠ©ç±»

4. **ä¿®å¤å®¡æŸ¥åé¦ˆ** (commit 16d5dac)
   - ä¸º `SafeExecute(ICabinetIsolator?, ...)` æ–¹æ³•æ·»åŠ äº†è¯¦ç»†æ–‡æ¡£
   - æ˜ç¡®è¯´æ˜ null å‚æ•°è¡Œä¸ºæ˜¯æœ‰æ„è®¾è®¡çš„
   - æ·»åŠ äº† `ArgumentNullException` éªŒè¯ action å‚æ•°
   - å¢å¼ºäº† XML æ–‡æ¡£å’Œ remarks è¯´æ˜

**æˆæœ**:
- âœ… SafeExecute å®ç°ä» **44 å¤„å‡å°‘åˆ° 9 å¤„**ï¼ˆå‡å°‘ 79%ï¼‰
  - 6 ä¸ªåœ¨ CabinetIsolatorï¼ˆæ ¸å¿ƒå®ç°ï¼ŒåŒ…å«å„ç§é‡è½½ï¼‰
  - 3 ä¸ªåœ¨ SafeOperationHelperï¼ˆSwagger åœºæ™¯è–„åŒ…è£…å™¨ï¼Œå¿…é¡»ä¿ç•™ï¼‰
- âœ… æ¶ˆé™¤äº†ä»£ç é‡å¤ï¼Œç»Ÿä¸€äº†å®‰å…¨æ‰§è¡Œæ¨¡å¼
- âœ… æ‰€æœ‰æµ‹è¯•é€šè¿‡ï¼ˆ171/184ï¼Œ13 ä¸ªå› ç¼ºå°‘ç¡¬ä»¶é©±åŠ¨è€Œå¤±è´¥ï¼Œç¬¦åˆé¢„æœŸï¼‰
- âœ… å®¡æŸ¥åé¦ˆå·²ä¿®å¤ï¼Œæ–‡æ¡£å®Œå–„

**ä¸ºä»€ä¹ˆ SafeOperationHelper å¿…é¡»ä¿ç•™ç‹¬ç«‹å®ç°ï¼Ÿ**
- Swagger é…ç½®ç±»ï¼ˆå¦‚ `CustomOperationFilter`, `ConfigureSwaggerOptions` ç­‰ï¼‰æ— æ³•ä½¿ç”¨ä¾èµ–æ³¨å…¥
- è¿™äº›ç±»åœ¨ Swagger é…ç½®é˜¶æ®µå®ä¾‹åŒ–ï¼Œæ—©äº DI å®¹å™¨å®Œå…¨åˆå§‹åŒ–
- æä¾›é™æ€æ–¹æ³•æ˜¯å”¯ä¸€å¯è¡Œçš„è§£å†³æ–¹æ¡ˆ

**å½±åˆ†èº«æ£€æµ‹ç»“æœ**:
å‰©ä½™ 9 å¤„å®ç°**ä¸æ˜¯"å½±åˆ†èº«"ï¼ˆä»£ç é‡å¤ï¼‰**ï¼Œè€Œæ˜¯åˆç†çš„æ¶æ„è®¾è®¡ï¼š
1. **CabinetIsolator (6ä¸ªæ–¹æ³•)** - æ ¸å¿ƒå®ç°çš„å¿…è¦é‡è½½
2. **SafeOperationHelper (3ä¸ªæ–¹æ³•)** - Swagger é…ç½®ä¸“ç”¨é™æ€æ–¹æ³•

---

### TD-DONE-001: ä»£ç é‡å¤æ£€æµ‹ç³»ç»Ÿ
**çŠ¶æ€**: âœ… å·²å®Œæˆ  
**å®Œæˆæ—¥æœŸ**: 2025-12-06  
**ä¼˜å…ˆçº§**: P1  
**è´Ÿè´£äºº**: Copilot

**é—®é¢˜æè¿°**:
ç¼ºå°‘è‡ªåŠ¨åŒ–çš„ä»£ç é‡å¤æ£€æµ‹æœºåˆ¶ï¼Œå¯¼è‡´"å½±åˆ†èº«"ä»£ç æŒç»­äº§ç”Ÿã€‚

**è§£å†³æ–¹æ¡ˆ**:
å®æ–½äº†å®Œæ•´çš„ä¸‰å±‚é˜²å¾¡ä½“ç³»ï¼š
1. é¢„é˜²å±‚ï¼šç¼–ç è§„èŒƒã€ä»£ç æ¨¡æ¿ã€æ¶æ„æŒ‡å¯¼
2. æ£€æµ‹å±‚ï¼šè‡ªåŠ¨åŒ–è„šæœ¬ã€pre-commit hookã€CI/CDé›†æˆ
3. ä¿®å¤å±‚ï¼šé‡æ„æŒ‡å—ã€ä»£ç å®¡æŸ¥æµç¨‹

**äº¤ä»˜ç‰©**:
- `ANTI_DUPLICATION_DEFENSE.md` - å®Œæ•´é˜²çº¿æ–‡æ¡£
- `tools/check-duplication.sh` - è‡ªåŠ¨åŒ–æ£€æµ‹è„šæœ¬
- `tools/pre-commit` - Git pre-commit hook
- `.github/workflows/anti-duplication.yml` - CIå·¥ä½œæµ
- æ›´æ–°çš„ `.editorconfig` è§„åˆ™

**éªŒè¯**:
- âœ… æ£€æµ‹è„šæœ¬æ­£å¸¸è¿è¡Œ
- âœ… CI/CDé›†æˆæˆåŠŸ
- âœ… æ–‡æ¡£å®Œæ•´

---

### TD-DONE-002: ä»£ç è´¨é‡åˆ†æ
**çŠ¶æ€**: âœ… å·²å®Œæˆ  
**å®Œæˆæ—¥æœŸ**: 2025-12-06  
**ä¼˜å…ˆçº§**: P1  
**è´Ÿè´£äºº**: Copilot

**é—®é¢˜æè¿°**:
ç¼ºå°‘å¯¹ç°æœ‰ä»£ç è´¨é‡çš„å…¨é¢åˆ†æå’Œæ”¹è¿›å»ºè®®ã€‚

**è§£å†³æ–¹æ¡ˆ**:
å¯¹346ä¸ªæºæ–‡ä»¶ï¼ˆ45,248è¡Œä»£ç ï¼‰è¿›è¡Œäº†å…¨é¢åˆ†æï¼Œç”Ÿæˆäº†è¯¦ç»†æŠ¥å‘Šã€‚

**äº¤ä»˜ç‰©**:
- `ISSUE_DETECTION_REPORT.md` - 11ç« èŠ‚æ·±åº¦åˆ†æ
- `QUICK_FIX_GUIDE.md` - ä¿®å¤æ¨¡æ¿å’ŒæŒ‡å—
- `ISSUE_SUMMARY.md` - ä¸€é¡µçº¸æ€»ç»“
- `DETECTED_ISSUES_EXAMPLES.md` - å…·ä½“ç¤ºä¾‹

**å…³é”®å‘ç°**:
- ä»£ç è´¨é‡è¯„åˆ†: 85/100
- è¯†åˆ«äº†227å¤„å¼‚å¸¸å¤„ç†é—®é¢˜
- è¯†åˆ«äº†72å¤„å¹¶å‘å®‰å…¨é—®é¢˜
- è¯†åˆ«äº†35å¤„èµ„æºç®¡ç†é—®é¢˜

**éªŒè¯**:
- âœ… åˆ†æå®Œæˆ
- âœ… æ–‡æ¡£ç”Ÿæˆ
- âœ… åŸºçº¿æŒ‡æ ‡å»ºç«‹

---

## ğŸ“Š æŠ€æœ¯å€ºåŠ¡ç»Ÿè®¡

### æŒ‰ä¼˜å…ˆçº§
- P0 (å…³é”®): 0ä¸ª
- P1 (é«˜): 1ä¸ª (TD-NEW-002 è¿›è¡Œä¸­)
- P2 (ä¸­): 4ä¸ª (TD-002, TD-003, TD-004, TD-005, TD-NEW-005)
- P3 (ä½): 4ä¸ª (TD-006, TD-007, TD-008, TD-NEW-006)
- **æ€»è®¡**: 9ä¸ªå¾…å¤„ç†/è¿›è¡Œä¸­ï¼Œ6ä¸ªå·²å®Œæˆ

### æŒ‰çŠ¶æ€
- â³ å¾…å¤„ç†: 7ä¸ª (TD-002, TD-003, TD-004, TD-005, TD-NEW-005, TD-006, TD-007, TD-008)
- ğŸ”„ è¿›è¡Œä¸­: 1ä¸ª (TD-NEW-002 - 53% å®Œæˆ)
- â³/âœ… å¾…å¤„ç†/å¯æ¥å—: 1ä¸ª (TD-NEW-006 - MAUI ä¾‹å¤–)
- âœ… å·²å®Œæˆ: 6ä¸ª (TD-NEW-001, TD-NEW-003, TD-NEW-004, TD-001, TD-DONE-001, TD-DONE-002, TD-DONE-003)
- ğŸš« å·²å–æ¶ˆ: 0ä¸ª
- ğŸ” å·²æ¨è¿Ÿ: 0ä¸ª

### æ€»ä½“å¥åº·åº¦
```
æŠ€æœ¯å€ºåŠ¡å¥åº·åº¦: 82/100

è®¡ç®—æ–¹å¼:
- åŸºç¡€åˆ†: 100
- P0æ¯ä¸ª: -25åˆ†
- P1æ¯ä¸ª: -10åˆ†
- P2æ¯ä¸ª: -3åˆ†
- P3æ¯ä¸ª: -1åˆ†

å½“å‰: 100 - (0Ã—25) - (1Ã—10) - (4Ã—3) - (4Ã—1) = 82

è¯´æ˜: ä» 76 åˆ†æå‡è‡³ 82 åˆ†ï¼Œå› ä¸ºå®Œæˆäº† 2 ä¸ª P2 é—®é¢˜ï¼ˆTD-NEW-003, TD-NEW-004ï¼‰
```

**å¥åº·åº¦è¯„çº§**:
- 90-100: ä¼˜ç§€ âœ…
- 75-89: è‰¯å¥½ âœ… â† å½“å‰ (82/100ï¼Œæå‡äº† 6 åˆ†)
- 60-74: ä¸€èˆ¬ âš ï¸
- 45-59: éœ€æ”¹è¿› ğŸ”´
- 0-44: å±é™© â›”

**è¶‹åŠ¿åˆ†æ**:
- ğŸ“ˆ æœ¬æ¬¡å®Œæˆ: +2 ä¸ª P2 é—®é¢˜ï¼ˆå¿«é€Ÿä¿®å¤ï¼‰
- ğŸ¯ å¿«é€Ÿä¿®å¤æˆåŠŸ: < 20 åˆ†é’Ÿè§£å†³ 2 ä¸ªé—®é¢˜
- ğŸ”„ è¿›è¡Œä¸­: TD-NEW-002 (53% å®Œæˆ)
- ğŸ“Š æ•´ä½“è¯„ä»·: **è‰¯å¥½**ï¼Œå¥åº·åº¦æå‡ï¼ŒæŠ€æœ¯å€ºåŠ¡å¾—åˆ°æœ‰æ•ˆæ§åˆ¶

---

## ğŸ¯ ä¸‹ä¸€æ­¥è¡ŒåŠ¨

### æœ¬å‘¨ï¼ˆ2025-12-15 è‡³ 2025-12-22ï¼‰

**ä¼˜å…ˆçº§ 1 - å¿«é€Ÿä¿®å¤ï¼ˆ< 1 å°æ—¶ï¼‰**:
1. [x] TD-NEW-003: ä¿®å¤ ApiResponse<T> sealed âœ… å·²å®Œæˆ
   - å·¥ä½œé‡: 5 åˆ†é’Ÿï¼ˆå®é™…ï¼š2 åˆ†é’Ÿï¼‰
   - å½±å“: æ— é£é™©
   - è´£ä»»äºº: GitHub Copilot
   - å®Œæˆæ—¥æœŸ: 2025-12-15

2. [x] TD-NEW-004: æ¶ˆé™¤é‡å¤ Key å¸¸é‡ âœ… å·²å®Œæˆ
   - å·¥ä½œé‡: 30 åˆ†é’Ÿï¼ˆå®é™…ï¼š15 åˆ†é’Ÿï¼‰
   - å½±å“: æ— é£é™©
   - è´£ä»»äºº: GitHub Copilot
   - å®Œæˆæ—¥æœŸ: 2025-12-15

**ä¼˜å…ˆçº§ 2 - ç»§ç»­è¿›è¡Œä¸­çš„å·¥ä½œ**:
3. [ ] TD-NEW-002: å®Œæˆ DateTime æŠ½è±¡åŒ–ï¼ˆå‰©ä½™ 23 æ–‡ä»¶ï¼‰
   - å·¥ä½œé‡: 4-6 å°æ—¶
   - å½“å‰è¿›åº¦: 53%
   - è´£ä»»äºº: ç»§ç»­å½“å‰ PR ä½œè€…

### ä¸‹å‘¨ï¼ˆ2025-12-23 è‡³ 2025-12-29ï¼‰

4. [ ] TD-NEW-005: å¼€å§‹ä¿®å¤ get; set;ï¼ˆé˜¶æ®µ 1ï¼‰
   - ä¿®å¤ Host å±‚ DTO
   - å®¡æŸ¥æœ€è¿‘ 3 ä¸ªæœˆæ–°å¢çš„ç±»

5. [ ] TD-002: å¼‚å¸¸å¤„ç†æ”¹è¿›ï¼ˆé˜¶æ®µ 1ï¼‰
   - ä¿®å¤çƒ­ç‚¹æ–‡ä»¶å‰ 5 ä¸ª
   - æ·»åŠ æ³¨é‡Šè¯´æ˜

### æœ¬æœˆå‰©ä½™æ—¶é—´ï¼ˆ2025-12-30+ï¼‰

6. [ ] æ›´æ–° copilot-instructions.md
   - æ·»åŠ  MAUI async void ä¾‹å¤–è¯´æ˜
   - æ›´æ–° Code Review æ£€æŸ¥æ¸…å•
   
7. [x] ç”Ÿæˆé¡¹ç›®é—®é¢˜æ£€æµ‹æŠ¥å‘Š âœ… å·²å®Œæˆ
   - åˆ›å»º PROJECT_ISSUES_DETECTED.md
   - æ›´æ–° TECHNICAL_DEBT.md
   - ä¿®å¤ 2 ä¸ªå¿«é€Ÿé—®é¢˜

---

## ğŸ“ å˜æ›´æ—¥å¿—

### 2025-12-15 (ä¸‹åˆ)
- âœ… **å¿«é€Ÿä¿®å¤å®Œæˆ**
  - TD-NEW-003: ApiResponse<T> æ·»åŠ  sealed ä¿®é¥°ç¬¦
  - TD-NEW-004: æ¶ˆé™¤é‡å¤ Key å¸¸é‡å®šä¹‰
  - æ€»è®¡ç”¨æ—¶: < 20 åˆ†é’Ÿ
  - å½±å“æ–‡ä»¶: 8 ä¸ªï¼ˆ1 ä¸ªæ–°å»º + 7 ä¸ªä¿®æ”¹ï¼‰

- ğŸ“ˆ **æŠ€æœ¯å€ºåŠ¡ç»Ÿè®¡æ›´æ–°**:
  - å¥åº·åº¦: 76/100 â†’ 82/100ï¼ˆæå‡ 6 åˆ†ï¼‰
  - å·²å®ŒæˆæŠ€æœ¯å€ºåŠ¡: 4 ä¸ª â†’ 6 ä¸ª
  - P2 æŠ€æœ¯å€ºåŠ¡: 6 ä¸ª â†’ 4 ä¸ª
  - æ€»è®¡: 11 ä¸ª â†’ 9 ä¸ªå¾…å¤„ç†/è¿›è¡Œä¸­

- ğŸ“„ **äº¤ä»˜ç‰©**:
  - æ–°å»º: `Infrastructure/Persistence/LiteDbConstants.cs`
  - ä¿®æ”¹: `Host/Dto/ApiResponse.cs` (æ·»åŠ  sealed)
  - ä¿®æ”¹: 6 ä¸ªæŒä¹…åŒ–å­˜å‚¨ç±»ï¼ˆå¼•ç”¨å…±äº«å¸¸é‡ï¼‰

### 2025-12-15 (ä¸Šåˆ)
- ğŸ“Š **å®Œæˆé¡¹ç›®é—®é¢˜å…¨é¢æ£€æµ‹**
  - åˆ›å»º `PROJECT_ISSUES_DETECTED.md` ç»¼åˆæŠ¥å‘Š
  - åŸºäº copilot-instructions.md è¿›è¡Œç³»ç»ŸåŒ–æ£€æµ‹
  - æ£€æµ‹è¦†ç›– 351 ä¸ª C# æ–‡ä»¶ï¼Œ45,000+ è¡Œä»£ç 
  
- ğŸ†• **æ–°å¢ 4 ä¸ªæŠ€æœ¯å€ºåŠ¡é¡¹**:
  - TD-NEW-003: ApiResponse<T> ç¼ºå°‘ sealed ä¿®é¥°ç¬¦ (P2)
  - TD-NEW-004: æŒä¹…åŒ–å­˜å‚¨ç±»ä¸­é‡å¤çš„ Key å¸¸é‡å®šä¹‰ (P2)
  - TD-NEW-005: å¤§é‡å±æ€§ä½¿ç”¨ get; set; è€Œé init (P2)
  - TD-NEW-006: MauiApp ä¸­ä½¿ç”¨ async void (P3, å¯æ¥å—ä¾‹å¤–)

- ğŸ“‰ **æ›´æ–°æŠ€æœ¯å€ºåŠ¡ç»Ÿè®¡**:
  - å¥åº·åº¦: 82/100 â†’ 76/100ï¼ˆå› æ–°å‘ç°é—®é¢˜ï¼‰
  - P2 æŠ€æœ¯å€ºåŠ¡: 3 ä¸ª â†’ 6 ä¸ª
  - P3 æŠ€æœ¯å€ºåŠ¡: 3 ä¸ª â†’ 4 ä¸ª
  - æ€»è®¡: 7 ä¸ª â†’ 11 ä¸ªå¾…å¤„ç†/è¿›è¡Œä¸­
  - è¯„çº§ç»´æŒ: **è‰¯å¥½** (75-89 åˆ†)

- âœ… **æ£€æµ‹ç»“æœæ€»ç»“**:
  - å‘ç° 4 ç±»æ–°é—®é¢˜ï¼ˆ3 ä¸ª P2 + 1 ä¸ª P3ï¼‰
  - ç¡®è®¤ 1 ä¸ªéé—®é¢˜ï¼ˆå‚å•† SDK ç»“æ„ä½“ï¼‰
  - 2 ä¸ªå¿«é€Ÿä¿®å¤æœºä¼šï¼ˆæ€»è®¡ < 1 å°æ—¶ï¼‰
  - é¡¹ç›®æ•´ä½“è´¨é‡ä¿æŒè‰¯å¥½æ°´å¹³

### 2025-12-14
- âœ… å®Œæˆ TD-NEW-001ï¼šæŠ€æœ¯å€ºåŠ¡æ–‡ä»¶ç»Ÿä¸€ç®¡ç†
  - åˆå¹¶ DEBT_CLEANUP_REPORT.md åˆ° TECHNICAL_DEBT.md
  - åˆ é™¤ DEBT_CLEANUP_REPORT.md
  - å»ºç«‹å•ä¸€æŠ€æœ¯å€ºåŠ¡æ–‡ä»¶è§„èŒƒ
- ğŸ”„ å¼€å§‹ TD-NEW-002ï¼šDateTime.Now/UtcNow æŠ½è±¡åŒ–ï¼ˆ22% å®Œæˆï¼‰
  - åˆ›å»º ISystemClock æ¥å£å’Œ SystemClock å®ç°
  - åœ¨ DI å®¹å™¨ä¸­æ³¨å†Œ ISystemClock
  - é‡æ„ 10/45 æ–‡ä»¶ï¼ˆInfrastructure å±‚ä¼˜å…ˆï¼‰
  - è¯¦ç»†è®°å½•å‰©ä½™ 38 æ–‡ä»¶æ¸…å•å’Œä¿®å¤æŒ‡å—
  - æä¾›å®Œæ•´çš„åˆ†é˜¶æ®µå®æ–½è®¡åˆ’
- æ›´æ–°æŠ€æœ¯å€ºåŠ¡ç»Ÿè®¡
  - å¥åº·åº¦ä» 78/100 æå‡åˆ° 82/100
  - P1 æŠ€æœ¯å€ºåŠ¡: TD-NEW-002 è¿›è¡Œä¸­ï¼ˆ22% å®Œæˆï¼‰
  - P2 æŠ€æœ¯å€ºåŠ¡ä» 3 ä¸ªä¿æŒ 3 ä¸ª
  - å·²å®ŒæˆæŠ€æœ¯å€ºåŠ¡ä» 3 ä¸ªå¢åŠ åˆ° 4 ä¸ª
- æ›´æ–° copilot-instructions.md
  - æ•´åˆ GENERAL_COPILOT_CODING_STANDARDS.md å…¨éƒ¨å†…å®¹
  - æ·»åŠ  11 ä¸ªæ–°æ ‡å‡†ç« èŠ‚
  - ç‰ˆæœ¬å‡çº§: v1.0 â†’ v2.0

### 2025-12-07
- âœ… å®Œæˆ TD-001ï¼šSafeExecute æ¨¡å¼é‡å¤å®ç°
  - ç§»é™¤ SafeOperationIsolator ç±»
  - æ›´æ–° SafeOperationHelper ä¸º ICabinetIsolator è–„åŒ…è£…å™¨
  - è¿ç§»æ‰€æœ‰æµ‹è¯•åˆ°ä½¿ç”¨ CabinetIsolator
  - SafeExecute å®ç°ä» 44 å¤„å‡å°‘åˆ° 9 å¤„
- æ›´æ–°æŠ€æœ¯å€ºåŠ¡ç»Ÿè®¡
  - å¥åº·åº¦ä» 68/100 æå‡åˆ° 78/100
  - P1 æŠ€æœ¯å€ºåŠ¡ä» 2 ä¸ªå‡å°‘åˆ° 1 ä¸ª
  - æ€»ä½“è¯„çº§ä»"ä¸€èˆ¬"æå‡åˆ°"è‰¯å¥½"

### 2025-12-06
- åˆ›å»ºæŠ€æœ¯å€ºåŠ¡è¿½è¸ªæ–‡æ¡£
- æ·»åŠ 8ä¸ªå¾…å¤„ç†æŠ€æœ¯å€ºåŠ¡é¡¹
- æ ‡è®°2ä¸ªå·²å®Œæˆé¡¹ï¼ˆä»£ç é‡å¤æ£€æµ‹ã€ä»£ç è´¨é‡åˆ†æï¼‰
- å»ºç«‹åŸºçº¿æŒ‡æ ‡å’Œå¥åº·åº¦è¯„åˆ†

---

## ğŸ“š ç›¸å…³æ–‡æ¡£

- [ISSUE_DETECTION_REPORT.md](ISSUE_DETECTION_REPORT.md) - é—®é¢˜æ£€æµ‹æŠ¥å‘Š
- [QUICK_FIX_GUIDE.md](QUICK_FIX_GUIDE.md) - å¿«é€Ÿä¿®å¤æŒ‡å—
- [ANTI_DUPLICATION_DEFENSE.md](ANTI_DUPLICATION_DEFENSE.md) - ä»£ç é‡å¤é˜²çº¿
- [ANTI_DUPLICATION_STATUS.md](ANTI_DUPLICATION_STATUS.md) - é˜²çº¿å®æ–½çŠ¶æ€

---

## ğŸ’¡ å¦‚ä½•ä½¿ç”¨æœ¬æ–‡æ¡£

### ä½œä¸ºå¼€å‘è€…
1. **æäº¤PRå‰**: æ£€æŸ¥æ˜¯å¦æœ‰P0æˆ–P1æŠ€æœ¯å€ºåŠ¡éœ€è¦å¤„ç†
2. **å¼€å‘æ–°åŠŸèƒ½æ—¶**: é¿å…å¼•å…¥æ–°çš„æŠ€æœ¯å€ºåŠ¡
3. **ä»£ç å®¡æŸ¥æ—¶**: å‚è€ƒæ­¤æ–‡æ¡£æ£€æŸ¥æ˜¯å¦å¼•å…¥æ–°å€ºåŠ¡

### ä½œä¸ºPRå®¡æŸ¥è€…
1. **å®¡æŸ¥PRæ—¶**: ç¡®è®¤ç›¸å…³æŠ€æœ¯å€ºåŠ¡å·²å¤„ç†
2. **å‘ç°æ–°å€ºåŠ¡**: åœ¨PRä¸­æ·»åŠ åˆ°æ­¤æ–‡æ¡£
3. **éªŒè¯ä¿®å¤**: ç¡®è®¤æ ‡è®°ä¸ºå®Œæˆçš„é¡¹ç¡®å®å·²ä¿®å¤

### ä½œä¸ºé¡¹ç›®è´Ÿè´£äºº
1. **æ¯å‘¨å®¡æŸ¥**: æ£€æŸ¥è¿›åº¦ï¼Œè°ƒæ•´ä¼˜å…ˆçº§
2. **æ¯æœˆå®¡æŸ¥**: è¯„ä¼°æ€»ä½“å¥åº·åº¦ï¼Œåˆ¶å®šæ”¹è¿›è®¡åˆ’
3. **å­£åº¦å®¡æŸ¥**: è¯„ä¼°æŠ€æœ¯å€ºåŠ¡ç®¡ç†æ•ˆæœ

---

**ç»´æŠ¤æ‰¿è¯º**: æœ¬æ–‡æ¡£å°†åœ¨æ¯ä¸ªPRä¸­æ›´æ–°ï¼Œç¡®ä¿æŠ€æœ¯å€ºåŠ¡è¿½è¸ªçš„å‡†ç¡®æ€§å’Œæ—¶æ•ˆæ€§ã€‚
